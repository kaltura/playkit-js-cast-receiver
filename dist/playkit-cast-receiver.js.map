{"version":3,"sources":["./cast/receiver/webpack/universalModuleDefinition","./cast/receiver/webpack/bootstrap","./cast/receiver/external {\"commonjs\":\"kaltura-player-js\",\"commonjs2\":\"kaltura-player-js\",\"amd\":\"kaltura-player-js\",\"root\":[\"KalturaPlayer\"]}","./cast/receiver/./cast-engine.js","./cast/receiver/./default-player-config.js","./cast/receiver/./error/error.js","./cast/receiver/./error/error-type.js","./cast/receiver/./player-loader.js","./cast/receiver/./receiver-tracks-manager.js","./cast/receiver/./receiver-ads-manager.js","./cast/receiver/./receiver-manager.js","./cast/receiver/./receiver-manager-api.js","./cast/receiver/./index.js"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","core","Track","Utils","FakeEvent","MediaType","getLogger","FakeEventTarget","EventManager","EventType","AudioTrack","TextTrack","AbrMode","MimeType","CastEngine","source","config","ABORT","CAN_PLAY","CAN_PLAY_THROUGH","DURATION_CHANGE","EMPTIED","ENDED","LOADED_DATA","LOADED_METADATA","LOAD_START","PAUSE","PLAY","PLAYING","PROGRESS","RATE_CHANGE","SEEKED","SEEKING","STALLED","TIME_UPDATE","SUSPEND","WAITING","_context","cast","framework","CastReceiverContext","getInstance","_playerManager","getPlayerManager","_eventManager","_createVideoElement","_init","canPlaySource","mimeType","mimetype","toLowerCase","_supportedMimeTypes","includes","drmData","DASH","createEngine","this","restore","reset","attach","videoElement","getVideoElement","listen","_seeking","_ended","isLive","dispatchEvent","broadcastStatus","_mediaElementEvents","forEach","mediaElementEvent","detach","runCapabilities","prepareVideoElement","getCapabilities","Promise","resolve","id","autoplay","mutedAutoPlay","_el","load","startTime","_logger","debug","_isLoaded","_parseTracks","ABR_MODE_CHANGED","AUTO","_tracks","tracks","play","_paused","pause","hideTextTrack","selectTextTrack","textTrack","TEXT_TRACK_CHANGED","selectedTextTrack","selectAudioTrack","audioTrack","AUDIO_TRACK_CHANGED","selectedAudioTrack","selectVideoTrack","videoTrack","VIDEO_TRACK_CHANGED","selectedVideoTrack","enableAdaptiveBitrate","isAdaptiveBitrateEnabled","getSelectedSource","copyDeep","_source","_config","sources","type","LIVE","seekToLiveEdge","range","getLiveSeekableRange","seek","end","getStartTimeOfDvrWindow","start","removeAll","destroy","_volume","_muted","Dom","removeAttribute","removeChild","parentNode","castMediaPlayerEl","document","getElementsByTagName","CAST_MEDIA_PLAYER_TAG","getMediaElement","castAudioTracks","getAudioTracksManager","getTracks","audioTracks","_parseAudioTracks","castTextTracks","getTextTracksManager","textTracks","_parseTextTracks","concat","track","settings","trackId","index","label","language","kind","subType","active","push","getCurrentTimeSec","getDurationSec","VOLUME_CHANGE","url","playsinline","playbackRate","getPlaybackRate","crossOrigin","HLS","PROGRESSIVE","SMOOTH_STREAMING","StreamType","EngineType","DefaultPlayerConfig","playback","preload","disableUserCache","streamPriority","engine","CAST","format","ui","disable","ReceiverError","code","description","ErrorType","unRegisterEngine","registerEngine","PlayerLoader","loadPlayer","castMediaElement","style","position","playerContainerEl","createElement","appendChild","body","HTML5","playerConfig","mergeDeep","targetId","player","setup","prependTo","TextStyleConverter","remote","TrackType","ReceiverTracksManager","_player","_attachListeners","setInitialTracks","mediaInfo","getMediaInformation","customData","_setInitialAudioTrack","audioLanguage","_setInitialTextTrack","textLanguage","addEventListener","events","REQUEST_EDIT_TRACKS_INFO","requestEvent","activeTrackIds","requestData","_handleAudioTrackSelection","_handleTextTrackSelection","textTrackStyle","_handleTextStyleSelection","TEXT","activeTextTrack","find","nextActiveTextTrack","selectTrack","offTrack","AUDIO","activeAudioTrack","nextActiveAudioTrack","textStyle","toPlayerTextStyle","textTracksManager","some","setActiveByLanguage","warn","audioTracksManager","length","audioTrackId","setActiveById","Ad","AdBreak","AdBreakType","CustomEventMessage","ReceiverAdsManager","AD_REACHED_25_PERCENT","AD_REACHED_50_PERCENT","AD_REACHED_75_PERCENT","positions","breakManager","getBreakManager","breaks","getBreaks","b","_sendEventAndCustomMessage","Event","AD_MANIFEST_LOADED","adBreaksPosition","breaksEvent","_toggleAdBreakListeners","adBreakOptions","_getAdBreakOptions","adBreak","AD_BREAK_START","_adBreak","AD_BREAK_END","findIndex","breakId","ALL_ADS_COMPLETED","adOptions","_getAdOptions","ad","breakClipId","AD_LOADED","_ad","AD_STARTED","_adIsPlaying","AD_COMPLETED","_adCanSkipTriggered","AD_PAUSED","AD_RESUMED","adDuration","getBreakClipDurationSec","adCurrentTime","getBreakClipCurrentTimeSec","percent","_timePercentEvent","AD_FIRST_QUARTILE","AD_MIDPOINT","AD_THIRD_QUARTILE","skippable","skipOffset","AD_CAN_SKIP","AD_PROGRESS","adProgress","currentTime","duration","muted","AD_MUTED","AD_VOLUME_CHANGED","skipAd","messages","RequestData","MessageType","SKIP_AD","sendLocalMediaRequest","_adLifecycleEventHandlers","PLAYER_LOAD_COMPLETE","_onPlayerLoadComplete","BREAK_STARTED","_onBreakStarted","BREAK_ENDED","_onBreakEnded","BREAK_CLIP_LOADING","_onBreakClipLoading","BREAK_CLIP_STARTED","_onBreakClipStarted","BREAK_CLIP_ENDED","_onBreakClipEnded","_adTrackingEventHandlers","_onAdPaused","_onAdResumed","_playerEventHandlers","MUTE_CHANGE","_onMuteChange","_onVolumeChange","keys","event","toggle","_adProgressIntervalId","setInterval","_onAdProgress","removeEventListener","clearInterval","options","currentBreak","getBreakById","_getAdBreakTypeByPosition","numAds","breakClipIds","PRE","POST","MID","currentBreakClip","getBreakClipById","contentId","contentType","title","indexOf","clickThroughUrl","posterUrl","whenSkippable","linear","payload","toUpperCase","sendCustomMessage","CUSTOM_CHANNEL","undefined","receiverManager","DrmScheme","CustomMessageType","CustomActionType","CustomActionMessage","ReceiverManager","LOAD","onLoad","MEDIA_STATUS","onMediaStatus","STOP","onStop","REQUEST_PLAY","_onRequestPlayEvent","REQUEST_PAUSE","_onRequestPauseEvent","_onPlayEvent","_onPlayerLoadCompleteEvent","system","SYSTEM_VOLUME_CHANGED","_onSystemVolumeChangedEvent","_tracksManager","_adsManager","getPlayer","defaultOptions","CastReceiverOptions","customNamespaces","JSON","loadRequestData","_reset","resovle","reject","media","mediaConfig","_maybeCreateVmapAdsRequest","_maybeReplaceAdTagTimestamp","ERROR","SOURCE_SELECTED","_onSourceSelected","loadMedia","setMedia","_destroy","mediaStatus","getMediaInfo","playerState","getPlayerState","addCustomMessageListener","customMessage","_onCustomMessage","_playerManagerEventHandlers","_messageInterceptorsHandlers","msg","setMessageInterceptor","_castContextEventHandlers","_shouldAutoPlay","_firstPlay","selectedSource","_handleAutoPlay","_handleLiveDvr","_setMediaInfo","_maybeSetDrmLicenseUrl","forceRedirectExternalStreams","Http","jsonp","contentUrl","data","redirectExternalStreamsHandler","streamType","BUFFERED","metadata","GenericMediaMetadata","subtitle","images","poster","hlsSegmentFormat","HlsSegmentFormat","TS","isDvr","removeSupportedMediaCommands","Command","SEEK","addSupportedMediaCommands","scheme","WIDEVINE","setMediaPlaybackInfoHandler","loadRequest","playbackConfig","protectionSystem","ContentProtection","licenseUrl","firstPlay","loadPlayerAndSetInitialTracks","ready","then","listenOnce","systemVolumeChangedEvent","volume","level","customMessageEvent","ACTION","_handleCustomAction","customAction","action","vmapAdsRequest","replaceTimestamp","adtag","regex","test","match","replace","Date","now","breakClips","breakClip","vastAdsRequest","adTagUrl","ReceiverManagerAPI","listener","VERSION","__VERSION__","NAME","__NAME__"],"mappings":"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","file":"playkit-cast-receiver.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"kaltura-player-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"receiver\", [\"kaltura-player-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"receiver\"] = factory(require(\"kaltura-player-js\"));\n\telse\n\t\troot[\"KalturaPlayer\"] = root[\"KalturaPlayer\"] || {}, root[\"KalturaPlayer\"][\"cast\"] = root[\"KalturaPlayer\"][\"cast\"] || {}, root[\"KalturaPlayer\"][\"cast\"][\"receiver\"] = factory(root[\"KalturaPlayer\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","// @flow\nimport {core} from 'kaltura-player-js';\nimport {CAST_MEDIA_PLAYER_TAG} from './player-loader';\n\nconst {Track, Utils, FakeEvent, MediaType, getLogger, FakeEventTarget, EventManager, EventType, AudioTrack, TextTrack, AbrMode, MimeType} = core;\n\nclass CastEngine extends FakeEventTarget {\n  static get id(): string {\n    return 'cast';\n  }\n\n  static canPlaySource(source: Object): boolean {\n    const mimeType = source.mimetype.toLowerCase();\n    const supported = CastEngine._supportedMimeTypes.includes(mimeType);\n    if (supported) {\n      if (source.drmData) {\n        return MimeType.DASH.includes(mimeType);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  static createEngine(source: Object, config: Object): Object {\n    return new this(source, config);\n  }\n\n  static _logger: any = getLogger('CastEngine');\n\n  static _supportedMimeTypes: Array<string> = [...MimeType.HLS, ...MimeType.DASH, ...MimeType.PROGRESSIVE, ...MimeType.SMOOTH_STREAMING];\n\n  _el: HTMLVideoElement;\n  _source: Object;\n  _config: Object;\n  _eventManager: EventManager;\n  _isLoaded: boolean = false;\n  _tracks: Array<Track> = [];\n  _volume: number = 1;\n  _muted: boolean = false;\n  _paused: boolean = false;\n  _seeking: boolean = false;\n  _ended: boolean = false;\n  _mediaElementEvents: Array<string> = [\n    EventType.ABORT,\n    EventType.CAN_PLAY,\n    EventType.CAN_PLAY_THROUGH,\n    EventType.DURATION_CHANGE,\n    EventType.EMPTIED,\n    EventType.ENDED,\n    EventType.LOADED_DATA,\n    EventType.LOADED_METADATA,\n    EventType.LOAD_START,\n    EventType.PAUSE,\n    EventType.PLAY,\n    EventType.PLAYING,\n    EventType.PROGRESS,\n    EventType.RATE_CHANGE,\n    EventType.SEEKED,\n    EventType.SEEKING,\n    EventType.STALLED,\n    EventType.TIME_UPDATE,\n    EventType.SUSPEND,\n    EventType.WAITING\n  ];\n\n  constructor(source: Object, config: Object) {\n    super();\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._createVideoElement();\n    this._init(source, config);\n  }\n\n  restore(source: Object, config: Object): void {\n    this.reset();\n    this._init(source, config);\n  }\n\n  attach(): void {\n    const videoElement = this.getVideoElement();\n    this._eventManager.listen(videoElement, EventType.SEEKED, () => (this._seeking = false));\n    this._eventManager.listen(videoElement, EventType.SEEKING, () => (this._seeking = true));\n    this._eventManager.listen(videoElement, EventType.ENDED, () => {\n      this._ended = true;\n      // Receiver has a problem where the current time isn't equals to the duration when\n      // playback is ended. This prevent from analytics plugins to report 100% reached.\n      // So we're trigger time update event again on ended and take care to handle this state also in the\n      // current time setter.\n      if (!this.isLive()) {\n        this.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n      }\n    });\n    if (this.isLive()) {\n      this._eventManager.listen(videoElement, EventType.TIME_UPDATE, () => this._playerManager.broadcastStatus(true));\n    }\n    this._mediaElementEvents.forEach(mediaElementEvent =>\n      this._eventManager.listen(videoElement, mediaElementEvent, () => this.dispatchEvent(new FakeEvent(mediaElementEvent)))\n    );\n  }\n\n  detach(): void {\n    // Empty implementation\n  }\n\n  static runCapabilities(): void {\n    // Empty implementation\n  }\n\n  static prepareVideoElement(): void {\n    // Empty implementation\n  }\n\n  static getCapabilities(): Promise<Object> {\n    return Promise.resolve({\n      [CastEngine.id]: {\n        autoplay: true,\n        mutedAutoPlay: true\n      }\n    });\n  }\n\n  get id(): string {\n    return CastEngine.id;\n  }\n\n  getVideoElement(): HTMLVideoElement {\n    return this._el;\n  }\n\n  load(startTime: ?number): Promise<Object> {\n    CastEngine._logger.debug('Load start', startTime);\n    this._isLoaded = true;\n    this._parseTracks();\n    this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, {mode: AbrMode.AUTO}));\n    CastEngine._logger.debug('Load end', this._tracks);\n    return Promise.resolve({tracks: this._tracks});\n  }\n\n  play(): void {\n    this._paused = false;\n  }\n\n  pause(): void {\n    this._paused = true;\n  }\n\n  hideTextTrack(): void {\n    // Empty implementation\n  }\n\n  selectTextTrack(textTrack: TextTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, {selectedTextTrack: textTrack}));\n  }\n\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, {selectedAudioTrack: audioTrack}));\n  }\n\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, {selectedVideoTrack: videoTrack}));\n  }\n\n  enableAdaptiveBitrate(): void {\n    // Empty implementation\n  }\n\n  isAdaptiveBitrateEnabled(): boolean {\n    return true;\n  }\n\n  getSelectedSource(): Object {\n    return Utils.Object.copyDeep(this._source);\n  }\n\n  isLive() {\n    return this._config.sources.type === MediaType.LIVE;\n  }\n\n  seekToLiveEdge(): void {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      this._playerManager.seek(range.end);\n    }\n  }\n\n  getStartTimeOfDvrWindow(): number {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      return range.start;\n    }\n    return 0;\n  }\n\n  reset(): void {\n    this._eventManager.removeAll();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n  }\n\n  destroy(): void {\n    this._eventManager.destroy();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._mediaElementEvents = [];\n    this._volume = 1;\n    this._muted = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n    if (this._el) {\n      Utils.Dom.removeAttribute(this._el, 'src');\n      Utils.Dom.removeChild(this._el.parentNode, this._el);\n    }\n  }\n\n  set currentTime(value: number): void {\n    // Empty implementation\n  }\n\n  get currentTime(): number {\n    if (this.isLive()) {\n      return this._playerManager.getCurrentTimeSec() - this.getStartTimeOfDvrWindow();\n    }\n    if (this._ended) {\n      return this._playerManager.getDurationSec();\n    }\n    return this._playerManager.getCurrentTimeSec();\n  }\n\n  set muted(value: boolean): void {\n    this._muted = value;\n  }\n\n  get muted(): boolean {\n    return this._muted;\n  }\n\n  set volume(value: number): void {\n    this._volume = value;\n    this.dispatchEvent(EventType.VOLUME_CHANGE);\n  }\n\n  get volume(): number {\n    return this._volume;\n  }\n\n  get paused(): boolean {\n    return this._paused;\n  }\n\n  get seeking(): boolean {\n    return this._seeking;\n  }\n\n  get buffered(): Array<any> {\n    return [];\n  }\n\n  get duration(): number {\n    if (this.isLive()) {\n      const range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        return range.end - this.getStartTimeOfDvrWindow();\n      }\n    }\n    return this._playerManager.getDurationSec();\n  }\n\n  get src(): string {\n    return this._isLoaded ? this._source.url : '';\n  }\n\n  set playsinline(playsinline: boolean): void {\n    // Empty implementation\n  }\n\n  get playsinline(): boolean {\n    return true;\n  }\n\n  set playbackRate(playbackRate: number): void {\n    // Empty implementation\n  }\n\n  get playbackRate(): number {\n    return this._playerManager.getPlaybackRate();\n  }\n\n  get playbackRates(): Array<number> {\n    return [1];\n  }\n\n  get defaultPlaybackRate(): number {\n    return 1;\n  }\n\n  set crossOrigin(crossOrigin: ?string): void {\n    // Empty implementation\n  }\n\n  get crossOrigin(): ?string {\n    // Empty implementation\n    return null;\n  }\n\n  get ended(): boolean {\n    return this._ended;\n  }\n\n  _createVideoElement(): void {\n    const castMediaPlayerEl: Object = document.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      this._el = castMediaPlayerEl.getMediaElement();\n    }\n  }\n\n  _init(source: Object, config: Object): void {\n    this._source = source;\n    this._config = config;\n    this.attach();\n  }\n\n  _parseTracks(): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const castAudioTracks = audioTracksManager.getTracks();\n    const audioTracks = this._parseAudioTracks(castAudioTracks);\n\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    const castTextTracks = textTracksManager.getTracks();\n    const textTracks = this._parseTextTracks(castTextTracks);\n\n    this._tracks = audioTracks.concat(textTracks);\n  }\n\n  _parseTextTracks(castTextTracks: Array<Object>): Array<TextTrack> {\n    const textTracks = [];\n    castTextTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        kind: track.subType || 'subtitles',\n        active: false\n      };\n      textTracks.push(new TextTrack(settings));\n    });\n    return textTracks;\n  }\n\n  _parseAudioTracks(castAudioTracks: Array<Object>): Array<AudioTrack> {\n    const audioTracks = [];\n    castAudioTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        active: false\n      };\n      audioTracks.push(new AudioTrack(settings));\n    });\n    return audioTracks;\n  }\n}\n\nexport {CastEngine};\n","// @flow\nimport {core} from 'kaltura-player-js';\n\nconst {StreamType, EngineType} = core;\n\nconst DefaultPlayerConfig: Object = {\n  playback: {\n    autoplay: false,\n    preload: 'none',\n    disableUserCache: true,\n    streamPriority: [\n      {\n        engine: EngineType.CAST,\n        format: StreamType.HLS\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.DASH\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.PROGRESSIVE\n      }\n    ]\n  },\n  ui: {\n    disable: true\n  }\n};\n\nexport {DefaultPlayerConfig};\n","// @flow\nclass ReceiverError {\n  code: number;\n  description: string;\n\n  constructor(type: Object) {\n    this.code = type.code;\n    this.description = type.description;\n  }\n}\n\nexport {ReceiverError};\n","// @flow\nconst ErrorType: {[type: string]: Object} = {\n  CAST_ELEMENT_NOT_FOUND: {\n    code: 100020,\n    description: \"<cast-media-element> tag isn't found in the DOM\"\n  }\n};\n\nexport {ErrorType};\n","// @flow\nimport {core, setup} from 'kaltura-player-js';\nimport {CastEngine} from './cast-engine';\nimport {DefaultPlayerConfig} from './default-player-config';\nimport {ReceiverError} from './error/error';\nimport {ErrorType} from './error/error-type';\n\nconst {Utils, unRegisterEngine, registerEngine, EngineType} = core;\n\nexport const CAST_MEDIA_PLAYER_TAG: string = 'cast-media-player';\nconst PLAYER_CONTAINER: string = 'kaltura-receiver-player-container';\n\nclass PlayerLoader {\n  static loadPlayer(config: Object): Object {\n    const castMediaPlayerEl = Utils.Dom.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      const castMediaElement = castMediaPlayerEl.getMediaElement();\n      castMediaElement.style.position = 'absolute';\n      const playerContainerEl = Utils.Dom.createElement('div');\n      playerContainerEl.id = PLAYER_CONTAINER;\n      Utils.Dom.appendChild(document.body, playerContainerEl);\n      unRegisterEngine(EngineType.HTML5);\n      registerEngine(EngineType.CAST, CastEngine);\n      const playerConfig = Utils.Object.mergeDeep({targetId: PLAYER_CONTAINER}, DefaultPlayerConfig, config);\n      const player = setup(playerConfig);\n      Utils.Dom.prependTo(playerContainerEl, castMediaElement.parentNode);\n      return player;\n    } else {\n      throw new ReceiverError(ErrorType.CAST_ELEMENT_NOT_FOUND);\n    }\n  }\n}\n\nexport {PlayerLoader};\n","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\n\nconst {TextStyleConverter} = remote;\nconst {TrackType, getLogger} = core;\n\nclass ReceiverTracksManager {\n  _logger: any = getLogger('ReceiverTracksManager');\n  _playerManager: Object;\n  _player: Object;\n\n  constructor(player: Object) {\n    this._playerManager = cast.framework.CastReceiverContext.getInstance().getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  setInitialTracks(): void {\n    const mediaInfo = this._playerManager.getMediaInformation();\n    this._logger.debug('Set initial tracks', mediaInfo.customData);\n    if (mediaInfo.customData) {\n      this._setInitialAudioTrack(mediaInfo.customData.audioLanguage);\n      this._setInitialTextTrack(mediaInfo.customData.textLanguage);\n    }\n  }\n\n  _attachListeners(): void {\n    this._playerManager.addEventListener(cast.framework.events.EventType.REQUEST_EDIT_TRACKS_INFO, requestEvent => {\n      const activeTrackIds = requestEvent.requestData.activeTrackIds;\n      if (activeTrackIds) {\n        this._handleAudioTrackSelection(activeTrackIds);\n        this._handleTextTrackSelection(activeTrackIds);\n      } else {\n        const textTrackStyle = requestEvent.requestData.textTrackStyle;\n        this._handleTextStyleSelection(textTrackStyle);\n      }\n    });\n  }\n\n  _handleTextTrackSelection(activeTrackIds: Array<number>): void {\n    const textTracks = this._player.getTracks(TrackType.TEXT);\n    const activeTextTrack = textTracks.find(t => t.active);\n    const nextActiveTextTrack = textTracks.find(t => activeTrackIds.includes(t.id));\n    if (nextActiveTextTrack) {\n      this._player.selectTrack(nextActiveTextTrack);\n    } else if (activeTextTrack && activeTextTrack.language !== 'off') {\n      const offTrack = textTracks.find(t => t.language === 'off');\n      this._player.selectTrack(offTrack);\n    }\n  }\n\n  _handleAudioTrackSelection(activeTrackIds: Array<number>): void {\n    const audioTracks = this._player.getTracks(TrackType.AUDIO);\n    const activeAudioTrack = audioTracks.find(t => t.active);\n    const nextActiveAudioTrack = audioTracks.find(t => activeTrackIds.includes(t.id));\n    if (activeAudioTrack && nextActiveAudioTrack && activeAudioTrack.id !== nextActiveAudioTrack.id) {\n      this._player.selectTrack(nextActiveAudioTrack);\n    }\n  }\n\n  _handleTextStyleSelection(textStyle: Object): void {\n    this._player.textStyle = TextStyleConverter.toPlayerTextStyle(textStyle);\n  }\n\n  _setInitialTextTrack(textLanguage: ?string): void {\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    const textTracks = this._player.getTracks(TrackType.TEXT);\n    if (textLanguage) {\n      if (textTracks.some(track => track.language === textLanguage)) {\n        this._logger.debug('Set initial text track - setActiveByLanguage', textLanguage);\n        textTracksManager.setActiveByLanguage(textLanguage);\n      } else {\n        this._logger.warn(`Text track ${textLanguage} doesn't exist in the supported text tracks`);\n      }\n    }\n  }\n\n  _setInitialAudioTrack(audioLanguage: ?string): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const audioTracks = audioTracksManager.getTracks();\n    this._logger.debug('Set initial audio track', audioLanguage, audioTracks);\n    if (audioTracks.length > 0) {\n      if (audioLanguage) {\n        this._logger.debug('Set initial audio track - setActiveByLanguage', audioLanguage);\n        audioTracksManager.setActiveByLanguage(audioLanguage);\n      } else {\n        const audioTrackId = audioTracks[0].trackId;\n        const audioTrack = this._player.getTracks(TrackType.AUDIO).find(t => t.id === audioTrackId);\n        if (audioTrack) {\n          this._logger.debug('Set initial audio track - setActiveById', audioTrackId);\n          audioTracksManager.setActiveById(audioTrackId);\n          this._player.selectTrack(audioTrack);\n        }\n      }\n    }\n  }\n}\n\nexport {ReceiverTracksManager};\n","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {CUSTOM_CHANNEL} from './receiver-manager';\n\nconst {EventType, Ad, AdBreak, AdBreakType, getLogger, FakeEvent} = core;\nconst {CustomEventMessage} = remote;\n\nclass ReceiverAdsManager {\n  _logger: any = getLogger('ReceiverAdsManager');\n  _context: Object;\n  _playerManager: Object;\n  _player: Object;\n  _adProgressIntervalId: ?IntervalID;\n  _ad: ?Ad;\n  _adBreak: ?AdBreak;\n  _adIsPlaying: boolean;\n  _adCanSkipTriggered: boolean = false;\n  _adLifecycleEventHandlers: {[event: string]: Function};\n  _adTrackingEventHandlers: {[event: string]: Function};\n  _playerEventHandlers: {[event: string]: Function};\n  _timePercentEvent: {[time: string]: boolean} = {\n    AD_REACHED_25_PERCENT: false,\n    AD_REACHED_50_PERCENT: false,\n    AD_REACHED_75_PERCENT: false\n  };\n\n  constructor(player: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  skipAd(): void {\n    this._logger.debug('Skip ad');\n    const requestData = new cast.framework.messages.RequestData(cast.framework.messages.MessageType.SKIP_AD);\n    this._playerManager.sendLocalMediaRequest(requestData);\n  }\n\n  adBreak(): boolean {\n    return !!this._adBreak;\n  }\n\n  _attachListeners(): void {\n    this._adLifecycleEventHandlers = {\n      [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadComplete.bind(this),\n      [cast.framework.events.EventType.BREAK_STARTED]: this._onBreakStarted.bind(this),\n      [cast.framework.events.EventType.BREAK_ENDED]: this._onBreakEnded.bind(this),\n      [cast.framework.events.EventType.BREAK_CLIP_LOADING]: this._onBreakClipLoading.bind(this),\n      [cast.framework.events.EventType.BREAK_CLIP_STARTED]: this._onBreakClipStarted.bind(this),\n      [cast.framework.events.EventType.BREAK_CLIP_ENDED]: this._onBreakClipEnded.bind(this)\n    };\n    this._adTrackingEventHandlers = {\n      [cast.framework.events.EventType.PAUSE]: this._onAdPaused.bind(this),\n      [cast.framework.events.EventType.PLAY]: this._onAdResumed.bind(this)\n    };\n    this._playerEventHandlers = {\n      [EventType.MUTE_CHANGE]: this._onMuteChange.bind(this),\n      [EventType.VOLUME_CHANGE]: this._onVolumeChange.bind(this)\n    };\n    Object.keys(this._adLifecycleEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adLifecycleEventHandlers[event]));\n  }\n\n  _onPlayerLoadComplete = () => {\n    const positions = [];\n    const breakManager = this._playerManager.getBreakManager();\n    if (breakManager) {\n      const breaks = breakManager.getBreaks();\n      if (breaks && breaks.length > 0) {\n        breaks.forEach(b => positions.push(b.position));\n        this._sendEventAndCustomMessage(this._player.Event.AD_MANIFEST_LOADED, {adBreaksPosition: positions});\n      }\n    }\n  };\n\n  _onBreakStarted = (breaksEvent: Object) => {\n    this._toggleAdBreakListeners(true);\n    const adBreakOptions = this._getAdBreakOptions(breaksEvent);\n    const adBreak = new AdBreak(adBreakOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_START, {adBreak: adBreak});\n    this._adBreak = adBreak;\n  };\n\n  _onBreakEnded = (breaksEvent: Object) => {\n    this._toggleAdBreakListeners(false);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_END);\n    this._adBreak = null;\n    const breaks = this._playerManager.getBreakManager().getBreaks();\n    const index = breaks.findIndex(b => b.id === breaksEvent.breakId);\n    if (index + 1 === breaks.length) {\n      this._sendEventAndCustomMessage(this._player.Event.ALL_ADS_COMPLETED);\n    }\n  };\n\n  _onBreakClipLoading = (breaksEvent: Object) => {\n    const adOptions = this._getAdOptions(breaksEvent);\n    const ad = new Ad(breaksEvent.breakClipId, adOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_LOADED, {ad: ad});\n    this._ad = ad;\n  };\n\n  _onBreakClipStarted = (breaksEvent: Object) => {\n    const adOptions = this._getAdOptions(breaksEvent);\n    const ad = new Ad(breaksEvent.breakClipId, adOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_STARTED, {ad});\n    this._adIsPlaying = true;\n  };\n\n  _onBreakClipEnded = () => {\n    this._sendEventAndCustomMessage(this._player.Event.AD_COMPLETED);\n    this._adIsPlaying = false;\n    this._adCanSkipTriggered = false;\n    this._ad = null;\n  };\n\n  _onAdPaused = () => {\n    this._sendEventAndCustomMessage(this._player.Event.AD_PAUSED);\n    this._adIsPlaying = false;\n  };\n\n  _onAdResumed = () => {\n    this._sendEventAndCustomMessage(this._player.Event.AD_RESUMED);\n    this._adIsPlaying = true;\n  };\n\n  _onAdProgress = () => {\n    if (!this._ad) return;\n    const adDuration = this._playerManager.getBreakClipDurationSec();\n    const adCurrentTime = this._playerManager.getBreakClipCurrentTimeSec();\n    const percent = adCurrentTime / adDuration;\n    if (!this._timePercentEvent.AD_REACHED_25_PERCENT && percent >= 0.25) {\n      this._timePercentEvent.AD_REACHED_25_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_FIRST_QUARTILE);\n    }\n    if (!this._timePercentEvent.AD_REACHED_50_PERCENT && percent >= 0.5) {\n      this._timePercentEvent.AD_REACHED_50_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_MIDPOINT);\n    }\n    if (!this._timePercentEvent.AD_REACHED_75_PERCENT && percent >= 0.75) {\n      this._timePercentEvent.AD_REACHED_75_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_THIRD_QUARTILE);\n    }\n    if (this._ad && !this._adCanSkipTriggered && this._ad && this._ad.skippable) {\n      if (adCurrentTime >= this._ad.skipOffset) {\n        this._sendEventAndCustomMessage(this._player.Event.AD_CAN_SKIP);\n        this._adCanSkipTriggered = true;\n      }\n    }\n    this._sendEventAndCustomMessage(this._player.Event.AD_PROGRESS, {\n      adProgress: {\n        currentTime: adCurrentTime,\n        duration: adDuration\n      }\n    });\n  };\n\n  _onMuteChange = () => {\n    if (this._player.muted) {\n      this._sendEventAndCustomMessage(this._player.Event.AD_MUTED);\n    }\n  };\n\n  _onVolumeChange = () => {\n    this._sendEventAndCustomMessage(this._player.Event.AD_VOLUME_CHANGED);\n  };\n\n  _toggleAdBreakListeners(toggle: boolean): void {\n    if (toggle) {\n      Object.keys(this._adTrackingEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adTrackingEventHandlers[event]));\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.addEventListener(event, this._playerEventHandlers[event]));\n      this._adProgressIntervalId = setInterval(this._onAdProgress.bind(this), 300);\n    } else {\n      Object.keys(this._adTrackingEventHandlers).forEach(event =>\n        this._playerManager.removeEventListener(event, this._adTrackingEventHandlers[event])\n      );\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.removeEventListener(event, this._playerEventHandlers[event]));\n      if (this._adProgressIntervalId) {\n        clearInterval(this._adProgressIntervalId);\n        this._adProgressIntervalId = null;\n      }\n    }\n  }\n\n  _getAdBreakOptions(breaksEvent: Object): Object {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    if (currentBreak) {\n      options.position = currentBreak.position;\n      options.type = this._getAdBreakTypeByPosition(currentBreak.position);\n      options.numAds = currentBreak.breakClipIds.length;\n    }\n    return options;\n  }\n\n  _getAdBreakTypeByPosition(position: number): void {\n    switch (position) {\n      case 0:\n        return AdBreakType.PRE;\n      case -1:\n        return AdBreakType.POST;\n      default:\n        return AdBreakType.MID;\n    }\n  }\n\n  _getAdOptions(breaksEvent: Object): Object {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    if (currentBreak) {\n      const currentBreakClip = this._playerManager.getBreakManager().getBreakClipById(breaksEvent.breakClipId);\n      options.url = currentBreakClip.contentId;\n      options.contentType = currentBreakClip.contentType;\n      options.title = currentBreakClip.title;\n      options.position = currentBreak.breakClipIds.indexOf(currentBreakClip.id) + 1;\n      options.duration = currentBreakClip.duration;\n      options.clickThroughUrl = currentBreakClip.clickThroughUrl;\n      options.posterUrl = currentBreakClip.posterUrl;\n      options.skipOffset = currentBreakClip.whenSkippable;\n      options.linear = true;\n    }\n    return options;\n  }\n\n  _sendEventAndCustomMessage(event: string, payload: any): void {\n    this._logger.debug(event.toUpperCase(), payload);\n    this._player.dispatchEvent(new FakeEvent(event, payload));\n    this._context.sendCustomMessage(CUSTOM_CHANNEL, undefined, new CustomEventMessage(event, payload));\n  }\n}\n\nexport {ReceiverAdsManager};\n","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {PlayerLoader} from './player-loader';\nimport {ReceiverTracksManager} from './receiver-tracks-manager';\nimport {ReceiverAdsManager} from './receiver-ads-manager';\n\nconst {FakeEvent, EventManager, DrmScheme, Utils, getLogger} = core;\nconst {CustomMessageType, CustomActionType, CustomActionMessage} = remote;\n\nexport const CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\nconst LIVE_EDGE = -1;\n\nclass ReceiverManager {\n  _logger: any = getLogger('ReceiverManager');\n  _context: Object;\n  _playerManager: Object;\n  _eventManager: EventManager;\n  _player: Object;\n  _shouldAutoPlay: boolean = true;\n  _firstPlay: boolean = true;\n  _tracksManager: ReceiverTracksManager;\n  _adsManager: ReceiverAdsManager;\n  _messageInterceptorsHandlers: {[message: string]: Function} = {\n    [cast.framework.messages.MessageType.LOAD]: this.onLoad,\n    [cast.framework.messages.MessageType.MEDIA_STATUS]: this.onMediaStatus,\n    [cast.framework.messages.MessageType.STOP]: this.onStop\n  };\n  _playerManagerEventHandlers: {[event: string]: Function} = {\n    [cast.framework.events.EventType.REQUEST_PLAY]: this._onRequestPlayEvent,\n    [cast.framework.events.EventType.REQUEST_PAUSE]: this._onRequestPauseEvent,\n    [cast.framework.events.EventType.PLAY]: this._onPlayEvent,\n    [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadCompleteEvent\n  };\n  _castContextEventHandlers: {[event: string]: Function} = {\n    [cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED]: this._onSystemVolumeChangedEvent\n  };\n\n  constructor(config: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._player = PlayerLoader.loadPlayer(config);\n    this._tracksManager = new ReceiverTracksManager(this._player);\n    this._adsManager = new ReceiverAdsManager(this._player);\n    this._attachListeners();\n  }\n\n  getPlayer(): Object {\n    return this._player;\n  }\n\n  start(options: Object): void {\n    const defaultOptions = new cast.framework.CastReceiverOptions();\n    defaultOptions.customNamespaces = {\n      [CUSTOM_CHANNEL]: cast.framework.system.MessageType.JSON\n    };\n    Utils.Object.mergeDeep(defaultOptions, options);\n    this._logger.debug('Start receiver', defaultOptions);\n    this._context.start(defaultOptions);\n  }\n\n  onLoad(loadRequestData: Object): Promise<Object> {\n    this._logger.debug('onLoad', loadRequestData);\n    this._reset();\n    return new Promise((resovle, reject) => {\n      const mediaInfo = loadRequestData.media.customData.mediaInfo;\n      const mediaConfig = loadRequestData.media.customData.mediaConfig;\n      this._maybeCreateVmapAdsRequest(loadRequestData.media);\n      this._maybeReplaceAdTagTimestamp(loadRequestData.media);\n      this._eventManager.listen(this._player, this._player.Event.ERROR, event => reject(event));\n      this._eventManager.listen(this._player, this._player.Event.SOURCE_SELECTED, event => this._onSourceSelected(event, loadRequestData, resovle));\n      if (mediaInfo) {\n        this._logger.debug('loadMedia', mediaInfo);\n        this._player.loadMedia(mediaInfo);\n      } else {\n        this._logger.debug('setMedia', mediaConfig);\n        this._player.setMedia(mediaConfig);\n      }\n    });\n  }\n\n  onStop(requestData: Object): Promise<Object> {\n    this._logger.debug('onStop', requestData);\n    this._destroy();\n    return requestData;\n  }\n\n  onMediaStatus(mediaStatus: Object): Promise<Object> {\n    this._logger.debug('mediaStatus', mediaStatus);\n    mediaStatus.customData = mediaStatus.customData || {};\n    if (this._player) {\n      mediaStatus.customData.mediaInfo = this._player.getMediaInfo();\n      if (this._player.isLive()) {\n        mediaStatus.currentTime = this._player.currentTime;\n        if (mediaStatus.media) {\n          mediaStatus.media.duration = this._player.duration;\n        }\n      }\n    }\n    if (mediaStatus.playerState !== this._playerManager.getPlayerState()) {\n      mediaStatus.playerState = this._playerManager.getPlayerState();\n    }\n    return mediaStatus;\n  }\n\n  _attachListeners(): void {\n    this._context.addCustomMessageListener(CUSTOM_CHANNEL, customMessage => this._onCustomMessage(customMessage));\n    Object.keys(this._playerManagerEventHandlers).forEach(event =>\n      this._playerManager.addEventListener(event, this._playerManagerEventHandlers[event].bind(this))\n    );\n    Object.keys(this._messageInterceptorsHandlers).forEach(msg =>\n      this._playerManager.setMessageInterceptor(msg, this._messageInterceptorsHandlers[msg].bind(this))\n    );\n    Object.keys(this._castContextEventHandlers).forEach(event =>\n      this._context.addEventListener(event, this._castContextEventHandlers[event].bind(this))\n    );\n  }\n\n  _reset(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.removeAll();\n    this._player.reset();\n  }\n\n  _destroy(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.destroy();\n    this._player.destroy();\n  }\n\n  _onSourceSelected(event: FakeEvent, loadRequestData: Object, resolve: Function): void {\n    const source = event.payload.selectedSource[0];\n    this._handleAutoPlay(loadRequestData);\n    this._handleLiveDvr(loadRequestData);\n    this._setMediaInfo(loadRequestData, source);\n    this._maybeSetDrmLicenseUrl(source);\n    const sources = this._player.config.sources;\n    if (sources.options && sources.options.forceRedirectExternalStreams) {\n      this._logger.debug('Redirect stream started');\n      Utils.Http.jsonp(loadRequestData.media.contentUrl, (data, url) => {\n        loadRequestData.media.contentUrl = sources.options.redirectExternalStreamsHandler(data, url);\n        this._logger.debug('Redirect stream ended', loadRequestData.media.contentUrl);\n        resolve(loadRequestData);\n      });\n    } else {\n      resolve(loadRequestData);\n    }\n  }\n\n  _setMediaInfo(loadRequestData: Object, source: Object): void {\n    loadRequestData.media.contentId = loadRequestData.media.contentId || source.id;\n    loadRequestData.media.contentUrl = loadRequestData.media.contentUrl || source.url;\n    loadRequestData.media.contentType = loadRequestData.media.contentType || source.mimetype;\n    loadRequestData.media.streamType = this._player.isLive() ? cast.framework.messages.StreamType.LIVE : cast.framework.messages.StreamType.BUFFERED;\n    loadRequestData.media.metadata = loadRequestData.media.metadata || new cast.framework.messages.GenericMediaMetadata();\n    loadRequestData.media.metadata.title = loadRequestData.media.metadata.title || this._player.config.sources.metadata.name;\n    loadRequestData.media.metadata.subtitle = loadRequestData.media.metadata.subtitle || this._player.config.sources.metadata.description;\n    loadRequestData.media.metadata.images = loadRequestData.media.metadata.images || [{url: this._player.config.sources.poster}];\n    loadRequestData.media.hlsSegmentFormat = loadRequestData.media.hlsSegmentFormat || cast.framework.messages.HlsSegmentFormat.TS;\n    this._logger.debug('Media info has been set', loadRequestData);\n  }\n\n  _handleAutoPlay(loadRequestData: Object): void {\n    if (!loadRequestData.autoplay) {\n      this._shouldAutoPlay = false;\n      loadRequestData.autoplay = true;\n    }\n  }\n\n  _handleLiveDvr(loadRequestData: Object): void {\n    if (this._player.isDvr()) {\n      if (loadRequestData.currentTime === LIVE_EDGE) {\n        delete loadRequestData.currentTime;\n        this._logger.debug(`Live DVR will seek to live edge`);\n      }\n      // Workaround to avoid Live & Dvr seek issue\n      this._playerManager.removeSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    } else if (!this._player.isLive()) {\n      this._playerManager.addSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    }\n  }\n\n  _maybeSetDrmLicenseUrl(source: Object): void {\n    if (source.drmData) {\n      const data = source.drmData.find(data => data.scheme === DrmScheme.WIDEVINE);\n      if (data) {\n        this._playerManager.setMediaPlaybackInfoHandler((loadRequest, playbackConfig) => {\n          playbackConfig.protectionSystem = cast.framework.ContentProtection.WIDEVINE;\n          playbackConfig.licenseUrl = data.licenseUrl;\n          this._logger.debug(`Set drm license url`, playbackConfig);\n          return playbackConfig;\n        });\n      }\n    }\n  }\n\n  _onPlayEvent(): void {\n    this._logger.debug('Play event', {firstPlay: this._firstPlay});\n    if (this._firstPlay) {\n      if (this._shouldAutoPlay) {\n        this._player.play();\n      } else {\n        this._playerManager.pause();\n      }\n      this._firstPlay = false;\n    }\n  }\n\n  _onRequestPlayEvent(): void {\n    this._logger.debug('Request play event');\n    this._player.play();\n  }\n\n  _onRequestPauseEvent(): void {\n    this._logger.debug('Request pause event');\n    this._player.pause();\n  }\n\n  _onPlayerLoadCompleteEvent(): void {\n    const loadPlayerAndSetInitialTracks = () => {\n      this._player.load();\n      this._player.ready().then(() => this._tracksManager.setInitialTracks());\n    };\n    this._logger.debug('Player load complete');\n    if (this._adsManager.adBreak()) {\n      this._eventManager.listenOnce(this._player, this._player.Event.AD_BREAK_END, () => {\n        this._eventManager.listenOnce(this._player, this._player.Event.PLAYING, loadPlayerAndSetInitialTracks);\n      });\n    } else {\n      loadPlayerAndSetInitialTracks();\n    }\n  }\n\n  _onSystemVolumeChangedEvent(systemVolumeChangedEvent: Object): void {\n    const data = systemVolumeChangedEvent.data;\n    if (this._player.volume !== data.level) {\n      this._player.volume = data.level;\n    }\n    if (this._player.muted !== data.muted) {\n      this._player.muted = data.muted;\n    }\n  }\n\n  _onCustomMessage(customMessageEvent: Object): void {\n    const customMessage = customMessageEvent.data;\n    this._logger.debug('Custom message received', customMessage);\n    switch (customMessage.type) {\n      case CustomMessageType.ACTION:\n        this._handleCustomAction(customMessage);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _handleCustomAction(customAction: CustomActionMessage): void {\n    switch (customAction.action) {\n      case CustomActionType.SKIP_AD:\n        this._adsManager.skipAd();\n        break;\n      default:\n        break;\n    }\n  }\n\n  _maybeCreateVmapAdsRequest(media: Object): void {\n    if (media.customData && media.customData.vmapAdsRequest) {\n      media.vmapAdsRequest = media.customData.vmapAdsRequest;\n    }\n  }\n\n  _maybeReplaceAdTagTimestamp(media: Object): void {\n    const replaceTimestamp = adtag => {\n      if (adtag && regex.test(adtag)) {\n        const match = adtag.match(regex);\n        return adtag.replace(match[1], Date.now());\n      }\n      return adtag;\n    };\n    const regex = /correlator=(\\[timestamp\\])/;\n    if (media.breakClips) {\n      const breakClips = media.breakClips;\n      breakClips.forEach(breakClip => {\n        if (breakClip.vastAdsRequest && breakClip.vastAdsRequest.adTagUrl) {\n          breakClip.vastAdsRequest.adTagUrl = replaceTimestamp(breakClip.vastAdsRequest.adTagUrl);\n        }\n      });\n    }\n    if (media.vmapAdsRequest) {\n      media.vmapAdsRequest.adTagUrl = replaceTimestamp(media.vmapAdsRequest.adTagUrl);\n    }\n  }\n}\n\nexport {ReceiverManager};\n","// @flow\nimport {ReceiverManager} from './receiver-manager';\n\nlet receiverManager;\n\n/**\n * Kaltura Receiver Player SDK.\n * @class Receiver\n * @param {KPReceiverOptionsObject} config - The receiver SDK configuration.\n */\nclass ReceiverManagerAPI {\n  constructor(config: KPReceiverOptionsObject) {\n    receiverManager = new ReceiverManager(config);\n  }\n\n  /**\n   * Initializes the receiver SDK, so that receiver app can receive requests from senders.\n   * Internally calls to cast.framework.CastReceiverContext.start() to initializes system manager and media manager.\n   * @public\n   * @instance\n   * @param {Object=} options - Cast receiver context options. All options are optional. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.CastReceiverOptions|cast.framework.CastReceiverOptions}\n   * @returns {void}\n   * @memberof Receiver\n   */\n  start(options?: Object = {}): void {\n    receiverManager.start(options);\n  }\n\n  /**\n   * The LOAD default handler of the receiver SDK. This handler should be called just in case LOAD interceptor is override by the app, otherwise it will be called internally.\n   * @public\n   * @instance\n   * @param {Object} loadRequestData - Media event LOAD request data. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.messages.LoadRequestData|cast.framework.messages.LoadRequestData}\n   * @returns {Promise<Object>} - The load promise.\n   * @memberof Receiver\n   */\n  onLoad(loadRequestData: Object): Promise<Object> {\n    return receiverManager.onLoad(loadRequestData);\n  }\n\n  /**\n   * Adding an event listener to a receiver player event.\n   * @public\n   * @instance\n   * @param {string} type - The event type.\n   * @param {Function} listener - The event handler.\n   * @returns {void}\n   * @memberof Receiver\n   */\n  addEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().addEventListener(type, listener);\n  }\n\n  /**\n   * Removing an event listener from a receiver player event.\n   * @public\n   * @instance\n   * @param {string} type - The event type.\n   * @param {Function} listener - The event handler.\n   * @returns {void}\n   * @memberof Receiver\n   */\n  removeEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().removeEventListener(type, listener);\n  }\n}\n\nexport {ReceiverManagerAPI};\n","// @flow\nimport {ReceiverManagerAPI} from './receiver-manager-api';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nconst VERSION = __VERSION__;\nconst NAME = __NAME__;\n\nexport {ReceiverManagerAPI as Receiver};\nexport {VERSION, NAME};\n"],"sourceRoot":""}