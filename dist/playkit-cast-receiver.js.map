{"version":3,"sources":["./cast/receiver/webpack/universalModuleDefinition","./cast/receiver/playkit-cast-receiver.js","./cast/receiver/webpack/bootstrap 61235113d10bf56a1d54","./cast/receiver/external {\"commonjs\":\"kaltura-player-js\",\"commonjs2\":\"kaltura-player-js\",\"amd\":\"kaltura-player-js\",\"root\":[\"KalturaPlayer\"]}","./cast/receiver/./receiver-manager.js","./cast/receiver/./player-loader.js","./cast/receiver/./index.js","./cast/receiver/./receiver-manager-api.js","./cast/receiver/./cast-engine.js","./cast/receiver/./default-player-config.js","./cast/receiver/./error/error.js","./cast/receiver/./error/error-type.js","./cast/receiver/./receiver-tracks-manager.js","./cast/receiver/./receiver-ads-manager.js"],"names":["root","factory","exports","module","require","define","amd","self","this","__WEBPACK_EXTERNAL_MODULE_0__","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_defineProperty","obj","key","value","writable","_classCallCheck","instance","Constructor","TypeError","ReceiverManager","CUSTOM_CHANNEL","undefined","_createClass","defineProperties","target","props","length","descriptor","protoProps","staticProps","_kalturaPlayerJs","_playerLoader","_receiverTracksManager","_receiverAdsManager","EventManager","core","FakeEvent","DrmScheme","Utils","getLogger","CustomMessageType","cast","CustomActionType","CustomActionMessage","config","_messageInterceptorsH","_playerManagerEventHa","_logger","_shouldAutoPlay","_firstPlay","_messageInterceptorsHandlers","framework","messages","MessageType","LOAD","onLoad","MEDIA_STATUS","onMediaStatus","STOP","onStop","_playerManagerEventHandlers","events","EventType","REQUEST_PLAY","_onRequestPlayEvent","REQUEST_PAUSE","_onRequestPauseEvent","PLAY","_onPlayEvent","PLAYER_LOAD_COMPLETE","_onPlayerLoadCompleteEvent","_castContextEventHandlers","system","SYSTEM_VOLUME_CHANGED","_onSystemVolumeChangedEvent","_context","CastReceiverContext","getInstance","_playerManager","getPlayerManager","_eventManager","_player","PlayerLoader","loadPlayer","_tracksManager","ReceiverTracksManager","_adsManager","ReceiverAdsManager","_attachListeners","options","defaultOptions","CastReceiverOptions","customNamespaces","JSON","mergeDeep","debug","start","loadRequestData","_this","_reset","Promise","resovle","reject","mediaInfo","media","customData","_maybeCreateVmapAdsRequest","_maybeReplaceAdTagTimestamp","listen","Event","ERROR","event","SOURCE_SELECTED","_onSourceSelected","loadMedia","requestData","_destroy","mediaStatus","getMediaInfo","isLive","currentTime","duration","playerState","getPlayerState","_this2","addCustomMessageListener","customMessage","_onCustomMessage","keys","forEach","addEventListener","bind","msg","setMessageInterceptor","removeAll","reset","destroy","resolve","_this3","source","payload","selectedSource","_handleAutoPlay","_handleLiveDvr","_setMediaInfo","_maybeSetDrmLicenseUrl","sources","forceRedirectExternalStreams","Http","jsonp","contentUrl","data","url","redirectExternalStreamsHandler","contentId","id","contentType","mimetype","streamType","StreamType","LIVE","BUFFERED","metadata","GenericMediaMetadata","title","subtitle","description","images","poster","hlsSegmentFormat","HlsSegmentFormat","TS","autoplay","isDvr","removeSupportedMediaCommands","Command","SEEK","addSupportedMediaCommands","_this4","drmData","find","scheme","WIDEVINE","setMediaPlaybackInfoHandler","loadRequest","playbackConfig","protectionSystem","ContentProtection","licenseUrl","firstPlay","play","pause","_this5","loadPlayerAndSetInitialTracks","load","ready","then","setInitialTracks","adBreak","listenOnce","AD_BREAK_END","PLAYING","systemVolumeChangedEvent","volume","level","muted","customMessageEvent","type","ACTION","_handleCustomAction","customAction","action","SKIP_AD","skipAd","vmapAdsRequest","replaceTimestamp","adtag","regex","test","match","replace","Date","now","breakClips","breakClip","vastAdsRequest","adTagUrl","CAST_MEDIA_PLAYER_TAG","_castEngine","_defaultPlayerConfig","_error","_errorType","unRegisterEngine","registerEngine","EngineType","castMediaPlayerEl","Dom","getElementsByTagName","castMediaElement","getMediaElement","style","position","playerContainerEl","createElement","appendChild","document","body","HTML5","CAST","CastEngine","playerConfig","targetId","DefaultPlayerConfig","player","setup","prependTo","parentNode","ReceiverError","ErrorType","CAST_ELEMENT_NOT_FOUND","NAME","VERSION","Receiver","_receiverManagerApi","ReceiverManagerAPI","_receiverManager","receiverManager","arguments","listener","getPlayer","removeEventListener","_toConsumableArray","arr","Array","isArray","arr2","from","_possibleConstructorReturn","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","Track","MediaType","FakeEventTarget","AudioTrack","TextTrack","AbrMode","MimeType","_FakeEventTarget","getPrototypeOf","_isLoaded","_tracks","_volume","_muted","_paused","_seeking","_ended","_mediaElementEvents","ABORT","CAN_PLAY","CAN_PLAY_THROUGH","DURATION_CHANGE","EMPTIED","ENDED","LOADED_DATA","LOADED_METADATA","LOAD_START","PAUSE","PROGRESS","RATE_CHANGE","SEEKED","SEEKING","STALLED","TIME_UPDATE","SUSPEND","WAITING","_createVideoElement","_init","mimeType","toLowerCase","_supportedMimeTypes","includes","DASH","videoElement","getVideoElement","dispatchEvent","broadcastStatus","mediaElementEvent","_el","startTime","_parseTracks","ABR_MODE_CHANGED","mode","AUTO","tracks","textTrack","TEXT_TRACK_CHANGED","selectedTextTrack","audioTrack","AUDIO_TRACK_CHANGED","selectedAudioTrack","videoTrack","VIDEO_TRACK_CHANGED","selectedVideoTrack","copyDeep","_source","_config","range","getLiveSeekableRange","seek","end","removeAttribute","removeChild","attach","audioTracksManager","getAudioTracksManager","castAudioTracks","getTracks","audioTracks","_parseAudioTracks","textTracksManager","getTextTracksManager","castTextTracks","textTracks","_parseTextTracks","concat","track","settings","trackId","index","label","language","kind","subType","active","push","set","getCurrentTimeSec","getStartTimeOfDvrWindow","getDurationSec","VOLUME_CHANGE","playsinline","playbackRate","getPlaybackRate","crossOrigin","mutedAutoPlay","HLS","PROGRESSIVE","SMOOTH_STREAMING","playback","preload","disableUserCache","streamPriority","engine","format","ui","disable","code","TextStyleConverter","TrackType","getMediaInformation","_setInitialAudioTrack","audioLanguage","_setInitialTextTrack","textLanguage","REQUEST_EDIT_TRACKS_INFO","requestEvent","activeTrackIds","_handleAudioTrackSelection","_handleTextTrackSelection","textTrackStyle","_handleTextStyleSelection","TEXT","activeTextTrack","t","nextActiveTextTrack","selectTrack","offTrack","AUDIO","activeAudioTrack","nextActiveAudioTrack","textStyle","toPlayerTextStyle","setActiveByLanguage","audioTrackId","setActiveById","Ad","AdBreak","AdBreakType","CustomEventMessage","_timePercentEvent","AD_REACHED_25_PERCENT","AD_REACHED_50_PERCENT","AD_REACHED_75_PERCENT","_bindMethods","RequestData","sendLocalMediaRequest","_adBreak","_onPlayerLoadComplete","_onBreakStarted","_onBreakEnded","_onBreakClipLoading","_onBreakClipStarted","_onBreakClipEnded","_onAdPaused","_onAdResumed","_onAdProgress","_onMuteChange","_onVolumeChange","_adLifecycleEventHand","_adTrackingEventHandl","_playerEventHandlers","_adLifecycleEventHandlers","BREAK_STARTED","BREAK_ENDED","BREAK_CLIP_LOADING","BREAK_CLIP_STARTED","BREAK_CLIP_ENDED","_adTrackingEventHandlers","MUTE_CHANGE","positions","breakManager","getBreakManager","breaks","getBreaks","b","_sendEventAndCustomMessage","AD_MANIFEST_LOADED","adBreaksPosition","breaksEvent","_toggleAdBreakListeners","adBreakOptions","_getAdBreakOptions","AD_BREAK_START","findIndex","breakId","ALL_ADS_COMPLETED","adOptions","_getAdOptions","ad","breakClipId","AD_LOADED","_ad","AD_STARTED","_adIsPlaying","AD_COMPLETED","_adCanSkipTriggered","AD_PAUSED","AD_RESUMED","adDuration","getBreakClipDurationSec","adCurrentTime","getBreakClipCurrentTimeSec","percent","AD_FIRST_QUARTILE","AD_MIDPOINT","AD_THIRD_QUARTILE","skippable","skipOffset","AD_CAN_SKIP","AD_PROGRESS","adProgress","AD_MUTED","AD_VOLUME_CHANGED","toggle","_adProgressIntervalId","setInterval","clearInterval","currentBreak","getBreakById","_getAdBreakTypeByPosition","numAds","breakClipIds","PRE","POST","MID","currentBreakClip","getBreakClipById","indexOf","clickThroughUrl","posterUrl","whenSkippable","linear","toUpperCase","sendCustomMessage"],"mappings":"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","file":"playkit-cast-receiver.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"kaltura-player-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"receiver\", [\"kaltura-player-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"receiver\"] = factory(require(\"kaltura-player-js\"));\n\telse\n\t\troot[\"KalturaPlayer\"] = root[\"KalturaPlayer\"] || {}, root[\"KalturaPlayer\"][\"cast\"] = root[\"KalturaPlayer\"][\"cast\"] || {}, root[\"KalturaPlayer\"][\"cast\"][\"receiver\"] = factory(root[\"KalturaPlayer\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"kaltura-player-js\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"receiver\", [\"kaltura-player-js\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"receiver\"] = factory(require(\"kaltura-player-js\"));\n\telse\n\t\troot[\"KalturaPlayer\"] = root[\"KalturaPlayer\"] || {}, root[\"KalturaPlayer\"][\"cast\"] = root[\"KalturaPlayer\"][\"cast\"] || {}, root[\"KalturaPlayer\"][\"cast\"][\"receiver\"] = factory(root[\"KalturaPlayer\"]);\n})(typeof self !== 'undefined' ? self : this, function(__WEBPACK_EXTERNAL_MODULE_0__) {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 3);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports) {\n\nmodule.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverManager = exports.CUSTOM_CHANNEL = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _playerLoader = __webpack_require__(2);\n\nvar _receiverTracksManager = __webpack_require__(9);\n\nvar _receiverAdsManager = __webpack_require__(10);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FakeEvent = _kalturaPlayerJs.core.FakeEvent,\n    EventManager = _kalturaPlayerJs.core.EventManager,\n    DrmScheme = _kalturaPlayerJs.core.DrmScheme,\n    Utils = _kalturaPlayerJs.core.Utils,\n    getLogger = _kalturaPlayerJs.core.getLogger;\nvar CustomMessageType = _kalturaPlayerJs.cast.CustomMessageType,\n    CustomActionType = _kalturaPlayerJs.cast.CustomActionType,\n    CustomActionMessage = _kalturaPlayerJs.cast.CustomActionMessage;\nvar CUSTOM_CHANNEL = exports.CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\nvar LIVE_EDGE = -1;\n\nvar ReceiverManager = function () {\n  function ReceiverManager(config) {\n    var _messageInterceptorsH, _playerManagerEventHa;\n\n    _classCallCheck(this, ReceiverManager);\n\n    this._logger = getLogger('ReceiverManager');\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._messageInterceptorsHandlers = (_messageInterceptorsH = {}, _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.LOAD, this.onLoad), _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.MEDIA_STATUS, this.onMediaStatus), _defineProperty(_messageInterceptorsH, cast.framework.messages.MessageType.STOP, this.onStop), _messageInterceptorsH);\n    this._playerManagerEventHandlers = (_playerManagerEventHa = {}, _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.REQUEST_PLAY, this._onRequestPlayEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.REQUEST_PAUSE, this._onRequestPauseEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.PLAY, this._onPlayEvent), _defineProperty(_playerManagerEventHa, cast.framework.events.EventType.PLAYER_LOAD_COMPLETE, this._onPlayerLoadCompleteEvent), _playerManagerEventHa);\n    this._castContextEventHandlers = _defineProperty({}, cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED, this._onSystemVolumeChangedEvent);\n\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._player = _playerLoader.PlayerLoader.loadPlayer(config);\n    this._tracksManager = new _receiverTracksManager.ReceiverTracksManager(this._player);\n    this._adsManager = new _receiverAdsManager.ReceiverAdsManager(this._player);\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverManager, [{\n    key: 'getPlayer',\n    value: function getPlayer() {\n      return this._player;\n    }\n  }, {\n    key: 'start',\n    value: function start(options) {\n      var defaultOptions = new cast.framework.CastReceiverOptions();\n      defaultOptions.customNamespaces = _defineProperty({}, CUSTOM_CHANNEL, cast.framework.system.MessageType.JSON);\n      Utils.Object.mergeDeep(defaultOptions, options);\n      this._logger.debug('Start receiver', defaultOptions);\n      this._context.start(defaultOptions);\n    }\n  }, {\n    key: 'onLoad',\n    value: function onLoad(loadRequestData) {\n      var _this = this;\n\n      this._logger.debug('onLoad', loadRequestData);\n      this._reset();\n      return new Promise(function (resovle, reject) {\n        var mediaInfo = loadRequestData.media.customData.mediaInfo;\n        _this._maybeCreateVmapAdsRequest(loadRequestData.media);\n        _this._maybeReplaceAdTagTimestamp(loadRequestData.media);\n        _this._eventManager.listen(_this._player, _this._player.Event.ERROR, function (event) {\n          return reject(event);\n        });\n        _this._eventManager.listen(_this._player, _this._player.Event.SOURCE_SELECTED, function (event) {\n          return _this._onSourceSelected(event, loadRequestData, resovle);\n        });\n        _this._player.loadMedia(mediaInfo);\n      });\n    }\n  }, {\n    key: 'onStop',\n    value: function onStop(requestData) {\n      this._logger.debug('onStop', requestData);\n      this._destroy();\n      return requestData;\n    }\n  }, {\n    key: 'onMediaStatus',\n    value: function onMediaStatus(mediaStatus) {\n      this._logger.debug('mediaStatus', mediaStatus);\n      mediaStatus.customData = mediaStatus.customData || {};\n      if (this._player) {\n        mediaStatus.customData.mediaInfo = this._player.getMediaInfo();\n        if (this._player.isLive()) {\n          mediaStatus.currentTime = this._player.currentTime;\n          if (mediaStatus.media) {\n            mediaStatus.media.duration = this._player.duration;\n          }\n        }\n      }\n      if (mediaStatus.playerState !== this._playerManager.getPlayerState()) {\n        mediaStatus.playerState = this._playerManager.getPlayerState();\n      }\n      return mediaStatus;\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _this2 = this;\n\n      this._context.addCustomMessageListener(CUSTOM_CHANNEL, function (customMessage) {\n        return _this2._onCustomMessage(customMessage);\n      });\n      Object.keys(this._playerManagerEventHandlers).forEach(function (event) {\n        return _this2._playerManager.addEventListener(event, _this2._playerManagerEventHandlers[event].bind(_this2));\n      });\n      Object.keys(this._messageInterceptorsHandlers).forEach(function (msg) {\n        return _this2._playerManager.setMessageInterceptor(msg, _this2._messageInterceptorsHandlers[msg].bind(_this2));\n      });\n      Object.keys(this._castContextEventHandlers).forEach(function (event) {\n        return _this2._context.addEventListener(event, _this2._castContextEventHandlers[event].bind(_this2));\n      });\n    }\n  }, {\n    key: '_reset',\n    value: function _reset() {\n      this._shouldAutoPlay = true;\n      this._firstPlay = true;\n      this._eventManager.removeAll();\n      this._player.reset();\n    }\n  }, {\n    key: '_destroy',\n    value: function _destroy() {\n      this._shouldAutoPlay = true;\n      this._firstPlay = true;\n      this._eventManager.destroy();\n      this._player.destroy();\n    }\n  }, {\n    key: '_onSourceSelected',\n    value: function _onSourceSelected(event, loadRequestData, resolve) {\n      var _this3 = this;\n\n      var source = event.payload.selectedSource[0];\n      this._handleAutoPlay(loadRequestData);\n      this._handleLiveDvr(loadRequestData);\n      this._setMediaInfo(loadRequestData, source);\n      this._maybeSetDrmLicenseUrl(source);\n      var sources = this._player.config.sources;\n      if (sources.options && sources.options.forceRedirectExternalStreams) {\n        this._logger.debug('Redirect stream started');\n        Utils.Http.jsonp(loadRequestData.media.contentUrl, function (data, url) {\n          loadRequestData.media.contentUrl = sources.options.redirectExternalStreamsHandler(data, url);\n          _this3._logger.debug('Redirect stream ended', loadRequestData.media.contentUrl);\n          resolve(loadRequestData);\n        });\n      } else {\n        resolve(loadRequestData);\n      }\n    }\n  }, {\n    key: '_setMediaInfo',\n    value: function _setMediaInfo(loadRequestData, source) {\n      loadRequestData.media.contentId = loadRequestData.media.contentId || source.id;\n      loadRequestData.media.contentUrl = loadRequestData.media.contentUrl || source.url;\n      loadRequestData.media.contentType = loadRequestData.media.contentType || source.mimetype;\n      loadRequestData.media.streamType = this._player.isLive() ? cast.framework.messages.StreamType.LIVE : cast.framework.messages.StreamType.BUFFERED;\n      loadRequestData.media.metadata = loadRequestData.media.metadata || new cast.framework.messages.GenericMediaMetadata();\n      loadRequestData.media.metadata.title = loadRequestData.media.metadata.title || this._player.config.sources.metadata.name;\n      loadRequestData.media.metadata.subtitle = loadRequestData.media.metadata.subtitle || this._player.config.sources.metadata.description;\n      loadRequestData.media.metadata.images = loadRequestData.media.metadata.images || [{ url: this._player.config.sources.poster }];\n      loadRequestData.media.hlsSegmentFormat = loadRequestData.media.hlsSegmentFormat || cast.framework.messages.HlsSegmentFormat.TS;\n      this._logger.debug('Media info has been set', loadRequestData);\n    }\n  }, {\n    key: '_handleAutoPlay',\n    value: function _handleAutoPlay(loadRequestData) {\n      if (!loadRequestData.autoplay) {\n        this._shouldAutoPlay = false;\n        loadRequestData.autoplay = true;\n      }\n    }\n  }, {\n    key: '_handleLiveDvr',\n    value: function _handleLiveDvr(loadRequestData) {\n      if (this._player.isDvr()) {\n        if (loadRequestData.currentTime === LIVE_EDGE) {\n          delete loadRequestData.currentTime;\n          this._logger.debug('Live DVR will seek to live edge');\n        }\n        // Workaround to avoid Live & Dvr seek issue\n        this._playerManager.removeSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n      } else if (!this._player.isLive()) {\n        this._playerManager.addSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n      }\n    }\n  }, {\n    key: '_maybeSetDrmLicenseUrl',\n    value: function _maybeSetDrmLicenseUrl(source) {\n      var _this4 = this;\n\n      if (source.drmData) {\n        var data = source.drmData.find(function (data) {\n          return data.scheme === DrmScheme.WIDEVINE;\n        });\n        if (data) {\n          this._playerManager.setMediaPlaybackInfoHandler(function (loadRequest, playbackConfig) {\n            playbackConfig.protectionSystem = cast.framework.ContentProtection.WIDEVINE;\n            playbackConfig.licenseUrl = data.licenseUrl;\n            _this4._logger.debug('Set drm license url', playbackConfig);\n            return playbackConfig;\n          });\n        }\n      }\n    }\n  }, {\n    key: '_onPlayEvent',\n    value: function _onPlayEvent() {\n      this._logger.debug('Play event', { firstPlay: this._firstPlay });\n      if (this._firstPlay) {\n        if (this._shouldAutoPlay) {\n          this._player.play();\n        } else {\n          this._playerManager.pause();\n        }\n        this._firstPlay = false;\n      }\n    }\n  }, {\n    key: '_onRequestPlayEvent',\n    value: function _onRequestPlayEvent() {\n      this._logger.debug('Request play event');\n      this._player.play();\n    }\n  }, {\n    key: '_onRequestPauseEvent',\n    value: function _onRequestPauseEvent() {\n      this._logger.debug('Request pause event');\n      this._player.pause();\n    }\n  }, {\n    key: '_onPlayerLoadCompleteEvent',\n    value: function _onPlayerLoadCompleteEvent() {\n      var _this5 = this;\n\n      var loadPlayerAndSetInitialTracks = function loadPlayerAndSetInitialTracks() {\n        _this5._player.load();\n        _this5._player.ready().then(function () {\n          return _this5._tracksManager.setInitialTracks();\n        });\n      };\n      this._logger.debug('Player load complete');\n      if (this._adsManager.adBreak()) {\n        this._eventManager.listenOnce(this._player, this._player.Event.AD_BREAK_END, function () {\n          _this5._eventManager.listenOnce(_this5._player, _this5._player.Event.PLAYING, loadPlayerAndSetInitialTracks);\n        });\n      } else {\n        loadPlayerAndSetInitialTracks();\n      }\n    }\n  }, {\n    key: '_onSystemVolumeChangedEvent',\n    value: function _onSystemVolumeChangedEvent(systemVolumeChangedEvent) {\n      var data = systemVolumeChangedEvent.data;\n      if (this._player.volume !== data.level) {\n        this._player.volume = data.level;\n      }\n      if (this._player.muted !== data.muted) {\n        this._player.muted = data.muted;\n      }\n    }\n  }, {\n    key: '_onCustomMessage',\n    value: function _onCustomMessage(customMessageEvent) {\n      var customMessage = customMessageEvent.data;\n      this._logger.debug('Custom message received', customMessage);\n      switch (customMessage.type) {\n        case CustomMessageType.ACTION:\n          this._handleCustomAction(customMessage);\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: '_handleCustomAction',\n    value: function _handleCustomAction(customAction) {\n      switch (customAction.action) {\n        case CustomActionType.SKIP_AD:\n          this._adsManager.skipAd();\n          break;\n        default:\n          break;\n      }\n    }\n  }, {\n    key: '_maybeCreateVmapAdsRequest',\n    value: function _maybeCreateVmapAdsRequest(media) {\n      if (media.customData && media.customData.vmapAdsRequest) {\n        media.vmapAdsRequest = media.customData.vmapAdsRequest;\n      }\n    }\n  }, {\n    key: '_maybeReplaceAdTagTimestamp',\n    value: function _maybeReplaceAdTagTimestamp(media) {\n      var replaceTimestamp = function replaceTimestamp(adtag) {\n        if (adtag && regex.test(adtag)) {\n          var match = adtag.match(regex);\n          return adtag.replace(match[1], Date.now());\n        }\n        return adtag;\n      };\n      var regex = /correlator=(\\[timestamp\\])/;\n      if (media.breakClips) {\n        var breakClips = media.breakClips;\n        breakClips.forEach(function (breakClip) {\n          if (breakClip.vastAdsRequest && breakClip.vastAdsRequest.adTagUrl) {\n            breakClip.vastAdsRequest.adTagUrl = replaceTimestamp(breakClip.vastAdsRequest.adTagUrl);\n          }\n        });\n      }\n      if (media.vmapAdsRequest) {\n        media.vmapAdsRequest.adTagUrl = replaceTimestamp(media.vmapAdsRequest.adTagUrl);\n      }\n    }\n  }]);\n\n  return ReceiverManager;\n}();\n\nexports.ReceiverManager = ReceiverManager;\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.PlayerLoader = exports.CAST_MEDIA_PLAYER_TAG = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _castEngine = __webpack_require__(5);\n\nvar _defaultPlayerConfig = __webpack_require__(6);\n\nvar _error = __webpack_require__(7);\n\nvar _errorType = __webpack_require__(8);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar Utils = _kalturaPlayerJs.core.Utils,\n    unRegisterEngine = _kalturaPlayerJs.core.unRegisterEngine,\n    registerEngine = _kalturaPlayerJs.core.registerEngine,\n    EngineType = _kalturaPlayerJs.core.EngineType;\nvar CAST_MEDIA_PLAYER_TAG = exports.CAST_MEDIA_PLAYER_TAG = 'cast-media-player';\nvar PLAYER_CONTAINER = 'kaltura-receiver-player-container';\n\nvar PlayerLoader = function () {\n  function PlayerLoader() {\n    _classCallCheck(this, PlayerLoader);\n  }\n\n  _createClass(PlayerLoader, null, [{\n    key: 'loadPlayer',\n    value: function loadPlayer(config) {\n      var castMediaPlayerEl = Utils.Dom.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n      if (castMediaPlayerEl) {\n        var castMediaElement = castMediaPlayerEl.getMediaElement();\n        castMediaElement.style.position = 'absolute';\n        var playerContainerEl = Utils.Dom.createElement('div');\n        playerContainerEl.id = PLAYER_CONTAINER;\n        Utils.Dom.appendChild(document.body, playerContainerEl);\n        unRegisterEngine(EngineType.HTML5);\n        registerEngine(EngineType.CAST, _castEngine.CastEngine);\n        var playerConfig = Utils.Object.mergeDeep({ targetId: PLAYER_CONTAINER }, _defaultPlayerConfig.DefaultPlayerConfig, config);\n        var player = (0, _kalturaPlayerJs.setup)(playerConfig);\n        Utils.Dom.prependTo(playerContainerEl, castMediaElement.parentNode);\n        return player;\n      } else {\n        throw new _error.ReceiverError(_errorType.ErrorType.CAST_ELEMENT_NOT_FOUND);\n      }\n    }\n  }]);\n\n  return PlayerLoader;\n}();\n\nexports.PlayerLoader = PlayerLoader;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.NAME = exports.VERSION = exports.Receiver = undefined;\n\nvar _receiverManagerApi = __webpack_require__(4);\n\nexports.Receiver = _receiverManagerApi.ReceiverManagerAPI;\nexports.VERSION = \"0.3.0\";\nexports.NAME = \"@playkit-js/playkit-js-cast-receiver\";\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverManagerAPI = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _receiverManager = __webpack_require__(1);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar receiverManager = void 0;\n\n/**\n * Kaltura Receiver Player SDK.\n * @class Receiver\n * @param {KPReceiverOptionsObject} config - The receiver SDK configuration.\n */\n\nvar ReceiverManagerAPI = function () {\n  function ReceiverManagerAPI(config) {\n    _classCallCheck(this, ReceiverManagerAPI);\n\n    receiverManager = new _receiverManager.ReceiverManager(config);\n  }\n\n  /**\n   * Initializes the receiver SDK, so that receiver app can receive requests from senders.\n   * Internally calls to cast.framework.CastReceiverContext.start() to initializes system manager and media manager.\n   * @public\n   * @instance\n   * @param {Object=} options - Cast receiver context options. All options are optional. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.CastReceiverOptions|cast.framework.CastReceiverOptions}\n   * @returns {void}\n   * @memberof Receiver\n   */\n\n\n  _createClass(ReceiverManagerAPI, [{\n    key: 'start',\n    value: function start() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n      receiverManager.start(options);\n    }\n\n    /**\n     * The LOAD default handler of the receiver SDK. This handler should be called just in case LOAD interceptor is override by the app, otherwise it will be called internally.\n     * @public\n     * @instance\n     * @param {Object} loadRequestData - Media event LOAD request data. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.messages.LoadRequestData|cast.framework.messages.LoadRequestData}\n     * @returns {Promise<Object>} - The load promise.\n     * @memberof Receiver\n     */\n\n  }, {\n    key: 'onLoad',\n    value: function onLoad(loadRequestData) {\n      return receiverManager.onLoad(loadRequestData);\n    }\n\n    /**\n     * Adding an event listener to a receiver player event.\n     * @public\n     * @instance\n     * @param {string} type - The event type.\n     * @param {Function} listener - The event handler.\n     * @returns {void}\n     * @memberof Receiver\n     */\n\n  }, {\n    key: 'addEventListener',\n    value: function addEventListener(type, listener) {\n      receiverManager.getPlayer().addEventListener(type, listener);\n    }\n\n    /**\n     * Removing an event listener from a receiver player event.\n     * @public\n     * @instance\n     * @param {string} type - The event type.\n     * @param {Function} listener - The event handler.\n     * @returns {void}\n     * @memberof Receiver\n     */\n\n  }, {\n    key: 'removeEventListener',\n    value: function removeEventListener(type, listener) {\n      receiverManager.getPlayer().removeEventListener(type, listener);\n    }\n  }]);\n\n  return ReceiverManagerAPI;\n}();\n\nexports.ReceiverManagerAPI = ReceiverManagerAPI;\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CastEngine = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _playerLoader = __webpack_require__(2);\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar Track = _kalturaPlayerJs.core.Track,\n    Utils = _kalturaPlayerJs.core.Utils,\n    FakeEvent = _kalturaPlayerJs.core.FakeEvent,\n    MediaType = _kalturaPlayerJs.core.MediaType,\n    getLogger = _kalturaPlayerJs.core.getLogger,\n    FakeEventTarget = _kalturaPlayerJs.core.FakeEventTarget,\n    EventManager = _kalturaPlayerJs.core.EventManager,\n    EventType = _kalturaPlayerJs.core.EventType,\n    AudioTrack = _kalturaPlayerJs.core.AudioTrack,\n    TextTrack = _kalturaPlayerJs.core.TextTrack,\n    AbrMode = _kalturaPlayerJs.core.AbrMode,\n    MimeType = _kalturaPlayerJs.core.MimeType;\n\nvar CastEngine = function (_FakeEventTarget) {\n  _inherits(CastEngine, _FakeEventTarget);\n\n  _createClass(CastEngine, null, [{\n    key: 'canPlaySource',\n    value: function canPlaySource(source) {\n      var mimeType = source.mimetype.toLowerCase();\n      var supported = CastEngine._supportedMimeTypes.includes(mimeType);\n      if (supported) {\n        if (source.drmData) {\n          return MimeType.DASH.includes(mimeType);\n        }\n        return true;\n      }\n      return false;\n    }\n  }, {\n    key: 'createEngine',\n    value: function createEngine(source, config) {\n      return new this(source, config);\n    }\n  }, {\n    key: 'id',\n    get: function get() {\n      return 'cast';\n    }\n  }]);\n\n  function CastEngine(source, config) {\n    _classCallCheck(this, CastEngine);\n\n    var _this = _possibleConstructorReturn(this, (CastEngine.__proto__ || Object.getPrototypeOf(CastEngine)).call(this));\n\n    _this._isLoaded = false;\n    _this._tracks = [];\n    _this._volume = 1;\n    _this._muted = false;\n    _this._paused = false;\n    _this._seeking = false;\n    _this._ended = false;\n    _this._mediaElementEvents = [EventType.ABORT, EventType.CAN_PLAY, EventType.CAN_PLAY_THROUGH, EventType.DURATION_CHANGE, EventType.EMPTIED, EventType.ENDED, EventType.LOADED_DATA, EventType.LOADED_METADATA, EventType.LOAD_START, EventType.PAUSE, EventType.PLAY, EventType.PLAYING, EventType.PROGRESS, EventType.RATE_CHANGE, EventType.SEEKED, EventType.SEEKING, EventType.STALLED, EventType.TIME_UPDATE, EventType.SUSPEND, EventType.WAITING];\n\n    _this._context = cast.framework.CastReceiverContext.getInstance();\n    _this._playerManager = _this._context.getPlayerManager();\n    _this._eventManager = new EventManager();\n    _this._createVideoElement();\n    _this._init(source, config);\n    return _this;\n  }\n\n  _createClass(CastEngine, [{\n    key: 'restore',\n    value: function restore(source, config) {\n      this.reset();\n      this._init(source, config);\n    }\n  }, {\n    key: 'attach',\n    value: function attach() {\n      var _this2 = this;\n\n      var videoElement = this.getVideoElement();\n      this._eventManager.listen(videoElement, EventType.SEEKED, function () {\n        return _this2._seeking = false;\n      });\n      this._eventManager.listen(videoElement, EventType.SEEKING, function () {\n        return _this2._seeking = true;\n      });\n      this._eventManager.listen(videoElement, EventType.ENDED, function () {\n        _this2._ended = true;\n        // Receiver has a problem where the current time isn't equals to the duration when\n        // playback is ended. This prevent from analytics plugins to report 100% reached.\n        // So we're trigger time update event again on ended and take care to handle this state also in the\n        // current time setter.\n        if (!_this2.isLive()) {\n          _this2.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n        }\n      });\n      if (this.isLive()) {\n        this._eventManager.listen(videoElement, EventType.TIME_UPDATE, function () {\n          return _this2._playerManager.broadcastStatus(true);\n        });\n      }\n      this._mediaElementEvents.forEach(function (mediaElementEvent) {\n        return _this2._eventManager.listen(videoElement, mediaElementEvent, function () {\n          return _this2.dispatchEvent(new FakeEvent(mediaElementEvent));\n        });\n      });\n    }\n  }, {\n    key: 'detach',\n    value: function detach() {\n      // Empty implementation\n    }\n  }, {\n    key: 'getVideoElement',\n    value: function getVideoElement() {\n      return this._el;\n    }\n  }, {\n    key: 'load',\n    value: function load(startTime) {\n      CastEngine._logger.debug('Load start', startTime);\n      this._isLoaded = true;\n      this._parseTracks();\n      this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, { mode: AbrMode.AUTO }));\n      CastEngine._logger.debug('Load end', this._tracks);\n      return Promise.resolve({ tracks: this._tracks });\n    }\n  }, {\n    key: 'play',\n    value: function play() {\n      this._paused = false;\n    }\n  }, {\n    key: 'pause',\n    value: function pause() {\n      this._paused = true;\n    }\n  }, {\n    key: 'hideTextTrack',\n    value: function hideTextTrack() {\n      // Empty implementation\n    }\n  }, {\n    key: 'selectTextTrack',\n    value: function selectTextTrack(textTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, { selectedTextTrack: textTrack }));\n    }\n  }, {\n    key: 'selectAudioTrack',\n    value: function selectAudioTrack(audioTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, { selectedAudioTrack: audioTrack }));\n    }\n  }, {\n    key: 'selectVideoTrack',\n    value: function selectVideoTrack(videoTrack) {\n      this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, { selectedVideoTrack: videoTrack }));\n    }\n  }, {\n    key: 'enableAdaptiveBitrate',\n    value: function enableAdaptiveBitrate() {\n      // Empty implementation\n    }\n  }, {\n    key: 'isAdaptiveBitrateEnabled',\n    value: function isAdaptiveBitrateEnabled() {\n      return true;\n    }\n  }, {\n    key: 'getSelectedSource',\n    value: function getSelectedSource() {\n      return Utils.Object.copyDeep(this._source);\n    }\n  }, {\n    key: 'isLive',\n    value: function isLive() {\n      return this._config.sources.type === MediaType.LIVE;\n    }\n  }, {\n    key: 'seekToLiveEdge',\n    value: function seekToLiveEdge() {\n      var range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        this._playerManager.seek(range.end);\n      }\n    }\n  }, {\n    key: 'getStartTimeOfDvrWindow',\n    value: function getStartTimeOfDvrWindow() {\n      var range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        return range.start;\n      }\n      return 0;\n    }\n  }, {\n    key: 'reset',\n    value: function reset() {\n      this._eventManager.removeAll();\n      this._tracks = [];\n      this._isLoaded = false;\n      this._paused = false;\n      this._seeking = false;\n      this._ended = false;\n    }\n  }, {\n    key: 'destroy',\n    value: function destroy() {\n      this._eventManager.destroy();\n      this._tracks = [];\n      this._isLoaded = false;\n      this._mediaElementEvents = [];\n      this._volume = 1;\n      this._muted = false;\n      this._paused = false;\n      this._seeking = false;\n      this._ended = false;\n      if (this._el) {\n        Utils.Dom.removeAttribute(this._el, 'src');\n        Utils.Dom.removeChild(this._el.parentNode, this._el);\n      }\n    }\n  }, {\n    key: '_createVideoElement',\n    value: function _createVideoElement() {\n      var castMediaPlayerEl = document.getElementsByTagName(_playerLoader.CAST_MEDIA_PLAYER_TAG)[0];\n      if (castMediaPlayerEl) {\n        this._el = castMediaPlayerEl.getMediaElement();\n      }\n    }\n  }, {\n    key: '_init',\n    value: function _init(source, config) {\n      this._source = source;\n      this._config = config;\n      this.attach();\n    }\n  }, {\n    key: '_parseTracks',\n    value: function _parseTracks() {\n      var audioTracksManager = this._playerManager.getAudioTracksManager();\n      var castAudioTracks = audioTracksManager.getTracks();\n      var audioTracks = this._parseAudioTracks(castAudioTracks);\n\n      var textTracksManager = this._playerManager.getTextTracksManager();\n      var castTextTracks = textTracksManager.getTracks();\n      var textTracks = this._parseTextTracks(castTextTracks);\n\n      this._tracks = audioTracks.concat(textTracks);\n    }\n  }, {\n    key: '_parseTextTracks',\n    value: function _parseTextTracks(castTextTracks) {\n      var textTracks = [];\n      castTextTracks.forEach(function (track) {\n        var settings = {\n          id: track.trackId,\n          index: track.trackId - 1,\n          label: track.name,\n          language: track.language,\n          kind: track.subType || 'subtitles',\n          active: false\n        };\n        textTracks.push(new TextTrack(settings));\n      });\n      return textTracks;\n    }\n  }, {\n    key: '_parseAudioTracks',\n    value: function _parseAudioTracks(castAudioTracks) {\n      var audioTracks = [];\n      castAudioTracks.forEach(function (track) {\n        var settings = {\n          id: track.trackId,\n          index: track.trackId - 1,\n          label: track.name,\n          language: track.language,\n          active: false\n        };\n        audioTracks.push(new AudioTrack(settings));\n      });\n      return audioTracks;\n    }\n  }, {\n    key: 'id',\n    get: function get() {\n      return CastEngine.id;\n    }\n  }, {\n    key: 'currentTime',\n    set: function set(value) {\n      // Empty implementation\n    },\n    get: function get() {\n      if (this.isLive()) {\n        return this._playerManager.getCurrentTimeSec() - this.getStartTimeOfDvrWindow();\n      }\n      if (this._ended) {\n        return this._playerManager.getDurationSec();\n      }\n      return this._playerManager.getCurrentTimeSec();\n    }\n  }, {\n    key: 'muted',\n    set: function set(value) {\n      this._muted = value;\n    },\n    get: function get() {\n      return this._muted;\n    }\n  }, {\n    key: 'volume',\n    set: function set(value) {\n      this._volume = value;\n      this.dispatchEvent(EventType.VOLUME_CHANGE);\n    },\n    get: function get() {\n      return this._volume;\n    }\n  }, {\n    key: 'paused',\n    get: function get() {\n      return this._paused;\n    }\n  }, {\n    key: 'seeking',\n    get: function get() {\n      return this._seeking;\n    }\n  }, {\n    key: 'buffered',\n    get: function get() {\n      return [];\n    }\n  }, {\n    key: 'duration',\n    get: function get() {\n      if (this.isLive()) {\n        var range = this._playerManager.getLiveSeekableRange();\n        if (range) {\n          return range.end - this.getStartTimeOfDvrWindow();\n        }\n      }\n      return this._playerManager.getDurationSec();\n    }\n  }, {\n    key: 'src',\n    get: function get() {\n      return this._isLoaded ? this._source.url : '';\n    }\n  }, {\n    key: 'playsinline',\n    set: function set(playsinline) {\n      // Empty implementation\n    },\n    get: function get() {\n      return true;\n    }\n  }, {\n    key: 'playbackRate',\n    set: function set(playbackRate) {\n      // Empty implementation\n    },\n    get: function get() {\n      return this._playerManager.getPlaybackRate();\n    }\n  }, {\n    key: 'playbackRates',\n    get: function get() {\n      return [1];\n    }\n  }, {\n    key: 'defaultPlaybackRate',\n    get: function get() {\n      return 1;\n    }\n  }, {\n    key: 'crossOrigin',\n    set: function set(crossOrigin) {\n      // Empty implementation\n    },\n    get: function get() {\n      // Empty implementation\n    }\n  }, {\n    key: 'ended',\n    get: function get() {\n      return this._ended;\n    }\n  }], [{\n    key: 'runCapabilities',\n    value: function runCapabilities() {\n      // Empty implementation\n    }\n  }, {\n    key: 'prepareVideoElement',\n    value: function prepareVideoElement() {\n      // Empty implementation\n    }\n  }, {\n    key: 'getCapabilities',\n    value: function getCapabilities() {\n      return Promise.resolve(_defineProperty({}, CastEngine.id, {\n        autoplay: true,\n        mutedAutoPlay: true\n      }));\n    }\n  }]);\n\n  return CastEngine;\n}(FakeEventTarget);\n\nCastEngine._logger = getLogger('CastEngine');\nCastEngine._supportedMimeTypes = [].concat(_toConsumableArray(MimeType.HLS), _toConsumableArray(MimeType.DASH), _toConsumableArray(MimeType.PROGRESSIVE), _toConsumableArray(MimeType.SMOOTH_STREAMING));\nexports.CastEngine = CastEngine;\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.DefaultPlayerConfig = undefined;\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar StreamType = _kalturaPlayerJs.core.StreamType,\n    EngineType = _kalturaPlayerJs.core.EngineType;\n\n\nvar DefaultPlayerConfig = {\n  playback: {\n    autoplay: false,\n    preload: 'none',\n    disableUserCache: true,\n    streamPriority: [{\n      engine: EngineType.CAST,\n      format: StreamType.HLS\n    }, {\n      engine: EngineType.CAST,\n      format: StreamType.DASH\n    }, {\n      engine: EngineType.CAST,\n      format: StreamType.PROGRESSIVE\n    }]\n  },\n  ui: {\n    disable: true\n  }\n};\n\nexports.DefaultPlayerConfig = DefaultPlayerConfig;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar ReceiverError = function ReceiverError(type) {\n  _classCallCheck(this, ReceiverError);\n\n  this.code = type.code;\n  this.description = type.description;\n};\n\nexports.ReceiverError = ReceiverError;\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar ErrorType = {\n  CAST_ELEMENT_NOT_FOUND: {\n    code: 100020,\n    description: \"<cast-media-element> tag isn't found in the DOM\"\n  }\n};\n\nexports.ErrorType = ErrorType;\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverTracksManager = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar TextStyleConverter = _kalturaPlayerJs.cast.TextStyleConverter;\nvar TrackType = _kalturaPlayerJs.core.TrackType,\n    getLogger = _kalturaPlayerJs.core.getLogger;\n\nvar ReceiverTracksManager = function () {\n  function ReceiverTracksManager(player) {\n    _classCallCheck(this, ReceiverTracksManager);\n\n    this._logger = getLogger('ReceiverTracksManager');\n\n    this._playerManager = cast.framework.CastReceiverContext.getInstance().getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverTracksManager, [{\n    key: 'setInitialTracks',\n    value: function setInitialTracks() {\n      var mediaInfo = this._playerManager.getMediaInformation();\n      this._logger.debug('Set initial tracks', mediaInfo.customData);\n      if (mediaInfo.customData) {\n        this._setInitialAudioTrack(mediaInfo.customData.audioLanguage);\n        this._setInitialTextTrack(mediaInfo.customData.textLanguage);\n      }\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _this = this;\n\n      this._playerManager.addEventListener(cast.framework.events.EventType.REQUEST_EDIT_TRACKS_INFO, function (requestEvent) {\n        var activeTrackIds = requestEvent.requestData.activeTrackIds;\n        if (activeTrackIds) {\n          _this._handleAudioTrackSelection(activeTrackIds);\n          _this._handleTextTrackSelection(activeTrackIds);\n        } else {\n          var textTrackStyle = requestEvent.requestData.textTrackStyle;\n          _this._handleTextStyleSelection(textTrackStyle);\n        }\n      });\n    }\n  }, {\n    key: '_handleTextTrackSelection',\n    value: function _handleTextTrackSelection(activeTrackIds) {\n      var textTracks = this._player.getTracks(TrackType.TEXT);\n      var activeTextTrack = textTracks.find(function (t) {\n        return t.active;\n      });\n      var nextActiveTextTrack = textTracks.find(function (t) {\n        return activeTrackIds.includes(t.id);\n      });\n      if (nextActiveTextTrack) {\n        this._player.selectTrack(nextActiveTextTrack);\n      } else if (activeTextTrack && activeTextTrack.language !== 'off') {\n        var offTrack = textTracks.find(function (t) {\n          return t.language === 'off';\n        });\n        this._player.selectTrack(offTrack);\n      }\n    }\n  }, {\n    key: '_handleAudioTrackSelection',\n    value: function _handleAudioTrackSelection(activeTrackIds) {\n      var audioTracks = this._player.getTracks(TrackType.AUDIO);\n      var activeAudioTrack = audioTracks.find(function (t) {\n        return t.active;\n      });\n      var nextActiveAudioTrack = audioTracks.find(function (t) {\n        return activeTrackIds.includes(t.id);\n      });\n      if (activeAudioTrack && nextActiveAudioTrack && activeAudioTrack.id !== nextActiveAudioTrack.id) {\n        this._player.selectTrack(nextActiveAudioTrack);\n      }\n    }\n  }, {\n    key: '_handleTextStyleSelection',\n    value: function _handleTextStyleSelection(textStyle) {\n      this._player.textStyle = TextStyleConverter.toPlayerTextStyle(textStyle);\n    }\n  }, {\n    key: '_setInitialTextTrack',\n    value: function _setInitialTextTrack(textLanguage) {\n      var textTracksManager = this._playerManager.getTextTracksManager();\n      if (textLanguage) {\n        this._logger.debug('Set initial text track - setActiveByLanguage', textLanguage);\n        textTracksManager.setActiveByLanguage(textLanguage);\n      }\n    }\n  }, {\n    key: '_setInitialAudioTrack',\n    value: function _setInitialAudioTrack(audioLanguage) {\n      var audioTracksManager = this._playerManager.getAudioTracksManager();\n      var audioTracks = audioTracksManager.getTracks();\n      this._logger.debug('Set initial audio track', audioLanguage, audioTracks);\n      if (audioTracks.length > 0) {\n        if (audioLanguage) {\n          this._logger.debug('Set initial audio track - setActiveByLanguage', audioLanguage);\n          audioTracksManager.setActiveByLanguage(audioLanguage);\n        } else {\n          var audioTrackId = audioTracks[0].trackId;\n          var audioTrack = this._player.getTracks(TrackType.AUDIO).find(function (t) {\n            return t.id === audioTrackId;\n          });\n          if (audioTrack) {\n            this._logger.debug('Set initial audio track - setActiveById', audioTrackId);\n            audioTracksManager.setActiveById(audioTrackId);\n            this._player.selectTrack(audioTrack);\n          }\n        }\n      }\n    }\n  }]);\n\n  return ReceiverTracksManager;\n}();\n\nexports.ReceiverTracksManager = ReceiverTracksManager;\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReceiverAdsManager = undefined;\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _kalturaPlayerJs = __webpack_require__(0);\n\nvar _receiverManager = __webpack_require__(1);\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar EventType = _kalturaPlayerJs.core.EventType,\n    Ad = _kalturaPlayerJs.core.Ad,\n    AdBreak = _kalturaPlayerJs.core.AdBreak,\n    AdBreakType = _kalturaPlayerJs.core.AdBreakType,\n    getLogger = _kalturaPlayerJs.core.getLogger,\n    FakeEvent = _kalturaPlayerJs.core.FakeEvent;\nvar CustomEventMessage = _kalturaPlayerJs.cast.CustomEventMessage;\n\nvar ReceiverAdsManager = function () {\n  function ReceiverAdsManager(player) {\n    _classCallCheck(this, ReceiverAdsManager);\n\n    this._logger = getLogger('ReceiverAdsManager');\n    this._timePercentEvent = {\n      AD_REACHED_25_PERCENT: false,\n      AD_REACHED_50_PERCENT: false,\n      AD_REACHED_75_PERCENT: false\n    };\n\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._player = player;\n    this._bindMethods();\n    this._attachListeners();\n  }\n\n  _createClass(ReceiverAdsManager, [{\n    key: 'skipAd',\n    value: function skipAd() {\n      this._logger.debug('Skip ad');\n      var requestData = new cast.framework.messages.RequestData(cast.framework.messages.MessageType.SKIP_AD);\n      this._playerManager.sendLocalMediaRequest(requestData);\n    }\n  }, {\n    key: 'adBreak',\n    value: function adBreak() {\n      return !!this._adBreak;\n    }\n  }, {\n    key: '_bindMethods',\n    value: function _bindMethods() {\n      this._onPlayerLoadComplete = this._onPlayerLoadComplete.bind(this);\n      this._onBreakStarted = this._onBreakStarted.bind(this);\n      this._onBreakEnded = this._onBreakEnded.bind(this);\n      this._onBreakClipLoading = this._onBreakClipLoading.bind(this);\n      this._onBreakClipStarted = this._onBreakClipStarted.bind(this);\n      this._onBreakClipEnded = this._onBreakClipEnded.bind(this);\n      this._onAdPaused = this._onAdPaused.bind(this);\n      this._onAdResumed = this._onAdResumed.bind(this);\n      this._onAdProgress = this._onAdProgress.bind(this);\n      this._onMuteChange = this._onMuteChange.bind(this);\n      this._onVolumeChange = this._onVolumeChange.bind(this);\n    }\n  }, {\n    key: '_attachListeners',\n    value: function _attachListeners() {\n      var _adLifecycleEventHand,\n          _adTrackingEventHandl,\n          _playerEventHandlers,\n          _this = this;\n\n      this._adLifecycleEventHandlers = (_adLifecycleEventHand = {}, _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.PLAYER_LOAD_COMPLETE, this._onPlayerLoadComplete), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_STARTED, this._onBreakStarted), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_ENDED, this._onBreakEnded), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_LOADING, this._onBreakClipLoading), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_STARTED, this._onBreakClipStarted), _defineProperty(_adLifecycleEventHand, cast.framework.events.EventType.BREAK_CLIP_ENDED, this._onBreakClipEnded), _adLifecycleEventHand);\n      this._adTrackingEventHandlers = (_adTrackingEventHandl = {}, _defineProperty(_adTrackingEventHandl, cast.framework.events.EventType.PAUSE, this._onAdPaused), _defineProperty(_adTrackingEventHandl, cast.framework.events.EventType.PLAY, this._onAdResumed), _adTrackingEventHandl);\n      this._playerEventHandlers = (_playerEventHandlers = {}, _defineProperty(_playerEventHandlers, EventType.MUTE_CHANGE, this._onMuteChange), _defineProperty(_playerEventHandlers, EventType.VOLUME_CHANGE, this._onVolumeChange), _playerEventHandlers);\n      Object.keys(this._adLifecycleEventHandlers).forEach(function (event) {\n        return _this._playerManager.addEventListener(event, _this._adLifecycleEventHandlers[event]);\n      });\n    }\n  }, {\n    key: '_onPlayerLoadComplete',\n    value: function _onPlayerLoadComplete() {\n      var positions = [];\n      var breakManager = this._playerManager.getBreakManager();\n      if (breakManager) {\n        var breaks = breakManager.getBreaks();\n        if (breaks && breaks.length > 0) {\n          breaks.forEach(function (b) {\n            return positions.push(b.position);\n          });\n          this._sendEventAndCustomMessage(this._player.Event.AD_MANIFEST_LOADED, { adBreaksPosition: positions });\n        }\n      }\n    }\n  }, {\n    key: '_onBreakStarted',\n    value: function _onBreakStarted(breaksEvent) {\n      this._toggleAdBreakListeners(true);\n      var adBreakOptions = this._getAdBreakOptions(breaksEvent);\n      var adBreak = new AdBreak(adBreakOptions);\n      this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_START, { adBreak: adBreak });\n      this._adBreak = adBreak;\n    }\n  }, {\n    key: '_onBreakEnded',\n    value: function _onBreakEnded(breaksEvent) {\n      this._toggleAdBreakListeners(false);\n      this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_END);\n      this._adBreak = null;\n      var breaks = this._playerManager.getBreakManager().getBreaks();\n      var index = breaks.findIndex(function (b) {\n        return b.id === breaksEvent.breakId;\n      });\n      if (index + 1 === breaks.length) {\n        this._sendEventAndCustomMessage(this._player.Event.ALL_ADS_COMPLETED);\n      }\n    }\n  }, {\n    key: '_onBreakClipLoading',\n    value: function _onBreakClipLoading(breaksEvent) {\n      var adOptions = this._getAdOptions(breaksEvent);\n      var ad = new Ad(breaksEvent.breakClipId, adOptions);\n      this._sendEventAndCustomMessage(this._player.Event.AD_LOADED, { ad: ad });\n      this._ad = ad;\n    }\n  }, {\n    key: '_onBreakClipStarted',\n    value: function _onBreakClipStarted(breaksEvent) {\n      var adOptions = this._getAdOptions(breaksEvent);\n      var ad = new Ad(breaksEvent.breakClipId, adOptions);\n      this._sendEventAndCustomMessage(this._player.Event.AD_STARTED, { ad: ad });\n      this._adIsPlaying = true;\n    }\n  }, {\n    key: '_onBreakClipEnded',\n    value: function _onBreakClipEnded() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_COMPLETED);\n      this._adIsPlaying = false;\n      this._adCanSkipTriggered = false;\n      this._ad = null;\n    }\n  }, {\n    key: '_onAdPaused',\n    value: function _onAdPaused() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_PAUSED);\n      this._adIsPlaying = false;\n    }\n  }, {\n    key: '_onAdResumed',\n    value: function _onAdResumed() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_RESUMED);\n      this._adIsPlaying = true;\n    }\n  }, {\n    key: '_onAdProgress',\n    value: function _onAdProgress() {\n      if (!this._ad) return;\n      var adDuration = this._playerManager.getBreakClipDurationSec();\n      var adCurrentTime = this._playerManager.getBreakClipCurrentTimeSec();\n      var percent = adCurrentTime / adDuration;\n      if (!this._timePercentEvent.AD_REACHED_25_PERCENT && percent >= 0.25) {\n        this._timePercentEvent.AD_REACHED_25_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_FIRST_QUARTILE);\n      }\n      if (!this._timePercentEvent.AD_REACHED_50_PERCENT && percent >= 0.5) {\n        this._timePercentEvent.AD_REACHED_50_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_MIDPOINT);\n      }\n      if (!this._timePercentEvent.AD_REACHED_75_PERCENT && percent >= 0.75) {\n        this._timePercentEvent.AD_REACHED_75_PERCENT = true;\n        this._sendEventAndCustomMessage(this._player.Event.AD_THIRD_QUARTILE);\n      }\n      if (!this._adCanSkipTriggered && this._ad.skippable) {\n        if (adCurrentTime >= this._ad.skipOffset) {\n          this._sendEventAndCustomMessage(this._player.Event.AD_CAN_SKIP);\n          this._adCanSkipTriggered = true;\n        }\n      }\n      this._sendEventAndCustomMessage(this._player.Event.AD_PROGRESS, {\n        adProgress: {\n          currentTime: adCurrentTime,\n          duration: adDuration\n        }\n      });\n    }\n  }, {\n    key: '_onMuteChange',\n    value: function _onMuteChange() {\n      if (this._player.muted) {\n        this._sendEventAndCustomMessage(this._player.Event.AD_MUTED);\n      }\n    }\n  }, {\n    key: '_onVolumeChange',\n    value: function _onVolumeChange() {\n      this._sendEventAndCustomMessage(this._player.Event.AD_VOLUME_CHANGED);\n    }\n  }, {\n    key: '_toggleAdBreakListeners',\n    value: function _toggleAdBreakListeners(toggle) {\n      var _this2 = this;\n\n      if (toggle) {\n        Object.keys(this._adTrackingEventHandlers).forEach(function (event) {\n          return _this2._playerManager.addEventListener(event, _this2._adTrackingEventHandlers[event]);\n        });\n        Object.keys(this._playerEventHandlers).forEach(function (event) {\n          return _this2._player.addEventListener(event, _this2._playerEventHandlers[event]);\n        });\n        this._adProgressIntervalId = setInterval(this._onAdProgress, 300);\n      } else {\n        Object.keys(this._adTrackingEventHandlers).forEach(function (event) {\n          return _this2._playerManager.removeEventListener(event, _this2._adTrackingEventHandlers[event]);\n        });\n        Object.keys(this._playerEventHandlers).forEach(function (event) {\n          return _this2._player.removeEventListener(event, _this2._playerEventHandlers[event]);\n        });\n        clearInterval(this._adProgressIntervalId);\n        this._adProgressIntervalId = null;\n      }\n    }\n  }, {\n    key: '_getAdBreakOptions',\n    value: function _getAdBreakOptions(breaksEvent) {\n      var options = {};\n      var currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n      if (currentBreak) {\n        options.position = currentBreak.position;\n        options.type = this._getAdBreakTypeByPosition(currentBreak.position);\n        options.numAds = currentBreak.breakClipIds.length;\n      }\n      return options;\n    }\n  }, {\n    key: '_getAdBreakTypeByPosition',\n    value: function _getAdBreakTypeByPosition(position) {\n      switch (position) {\n        case 0:\n          return AdBreakType.PRE;\n        case -1:\n          return AdBreakType.POST;\n        default:\n          return AdBreakType.MID;\n      }\n    }\n  }, {\n    key: '_getAdOptions',\n    value: function _getAdOptions(breaksEvent) {\n      var options = {};\n      var currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n      if (currentBreak) {\n        var currentBreakClip = this._playerManager.getBreakManager().getBreakClipById(breaksEvent.breakClipId);\n        options.url = currentBreakClip.contentId;\n        options.contentType = currentBreakClip.contentType;\n        options.title = currentBreakClip.title;\n        options.position = currentBreak.breakClipIds.indexOf(currentBreakClip.id) + 1;\n        options.duration = currentBreakClip.duration;\n        options.clickThroughUrl = currentBreakClip.clickThroughUrl;\n        options.posterUrl = currentBreakClip.posterUrl;\n        options.skipOffset = currentBreakClip.whenSkippable;\n        options.linear = true;\n      }\n      return options;\n    }\n  }, {\n    key: '_sendEventAndCustomMessage',\n    value: function _sendEventAndCustomMessage(event, payload) {\n      this._logger.debug(event.toUpperCase(), payload);\n      this._player.dispatchEvent(new FakeEvent(event, payload));\n      this._context.sendCustomMessage(_receiverManager.CUSTOM_CHANNEL, undefined, new CustomEventMessage(event, payload));\n    }\n  }]);\n\n  return ReceiverAdsManager;\n}();\n\nexports.ReceiverAdsManager = ReceiverAdsManager;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// playkit-cast-receiver.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 3);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 61235113d10bf56a1d54","module.exports = __WEBPACK_EXTERNAL_MODULE_0__;\n\n\n//////////////////\n// WEBPACK FOOTER\n// external {\"commonjs\":\"kaltura-player-js\",\"commonjs2\":\"kaltura-player-js\",\"amd\":\"kaltura-player-js\",\"root\":[\"KalturaPlayer\"]}\n// module id = 0\n// module chunks = 0","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {PlayerLoader} from './player-loader';\nimport {ReceiverTracksManager} from './receiver-tracks-manager';\nimport {ReceiverAdsManager} from './receiver-ads-manager';\n\nconst {FakeEvent, EventManager, DrmScheme, Utils, getLogger} = core;\nconst {CustomMessageType, CustomActionType, CustomActionMessage} = remote;\n\nexport const CUSTOM_CHANNEL = 'urn:x-cast:com.kaltura.cast.playkit';\nconst LIVE_EDGE = -1;\n\nclass ReceiverManager {\n  _logger: any = getLogger('ReceiverManager');\n  _context: Object;\n  _playerManager: Object;\n  _eventManager: EventManager;\n  _player: Object;\n  _shouldAutoPlay: boolean = true;\n  _firstPlay: boolean = true;\n  _tracksManager: ReceiverTracksManager;\n  _adsManager: ReceiverAdsManager;\n  _messageInterceptorsHandlers: {[message: string]: Function} = {\n    [cast.framework.messages.MessageType.LOAD]: this.onLoad,\n    [cast.framework.messages.MessageType.MEDIA_STATUS]: this.onMediaStatus,\n    [cast.framework.messages.MessageType.STOP]: this.onStop\n  };\n  _playerManagerEventHandlers: {[event: string]: Function} = {\n    [cast.framework.events.EventType.REQUEST_PLAY]: this._onRequestPlayEvent,\n    [cast.framework.events.EventType.REQUEST_PAUSE]: this._onRequestPauseEvent,\n    [cast.framework.events.EventType.PLAY]: this._onPlayEvent,\n    [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadCompleteEvent\n  };\n  _castContextEventHandlers: {[event: string]: Function} = {\n    [cast.framework.system.EventType.SYSTEM_VOLUME_CHANGED]: this._onSystemVolumeChangedEvent\n  };\n\n  constructor(config: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._player = PlayerLoader.loadPlayer(config);\n    this._tracksManager = new ReceiverTracksManager(this._player);\n    this._adsManager = new ReceiverAdsManager(this._player);\n    this._attachListeners();\n  }\n\n  getPlayer(): Object {\n    return this._player;\n  }\n\n  start(options: Object): void {\n    const defaultOptions = new cast.framework.CastReceiverOptions();\n    defaultOptions.customNamespaces = {\n      [CUSTOM_CHANNEL]: cast.framework.system.MessageType.JSON\n    };\n    Utils.Object.mergeDeep(defaultOptions, options);\n    this._logger.debug('Start receiver', defaultOptions);\n    this._context.start(defaultOptions);\n  }\n\n  onLoad(loadRequestData: Object): Promise<Object> {\n    this._logger.debug('onLoad', loadRequestData);\n    this._reset();\n    return new Promise((resovle, reject) => {\n      const mediaInfo = loadRequestData.media.customData.mediaInfo;\n      this._maybeCreateVmapAdsRequest(loadRequestData.media);\n      this._maybeReplaceAdTagTimestamp(loadRequestData.media);\n      this._eventManager.listen(this._player, this._player.Event.ERROR, event => reject(event));\n      this._eventManager.listen(this._player, this._player.Event.SOURCE_SELECTED, event => this._onSourceSelected(event, loadRequestData, resovle));\n      this._player.loadMedia(mediaInfo);\n    });\n  }\n\n  onStop(requestData: Object): Promise<Object> {\n    this._logger.debug('onStop', requestData);\n    this._destroy();\n    return requestData;\n  }\n\n  onMediaStatus(mediaStatus: Object): Promise<Object> {\n    this._logger.debug('mediaStatus', mediaStatus);\n    mediaStatus.customData = mediaStatus.customData || {};\n    if (this._player) {\n      mediaStatus.customData.mediaInfo = this._player.getMediaInfo();\n      if (this._player.isLive()) {\n        mediaStatus.currentTime = this._player.currentTime;\n        if (mediaStatus.media) {\n          mediaStatus.media.duration = this._player.duration;\n        }\n      }\n    }\n    if (mediaStatus.playerState !== this._playerManager.getPlayerState()) {\n      mediaStatus.playerState = this._playerManager.getPlayerState();\n    }\n    return mediaStatus;\n  }\n\n  _attachListeners(): void {\n    this._context.addCustomMessageListener(CUSTOM_CHANNEL, customMessage => this._onCustomMessage(customMessage));\n    Object.keys(this._playerManagerEventHandlers).forEach(event =>\n      this._playerManager.addEventListener(event, this._playerManagerEventHandlers[event].bind(this))\n    );\n    Object.keys(this._messageInterceptorsHandlers).forEach(msg =>\n      this._playerManager.setMessageInterceptor(msg, this._messageInterceptorsHandlers[msg].bind(this))\n    );\n    Object.keys(this._castContextEventHandlers).forEach(event =>\n      this._context.addEventListener(event, this._castContextEventHandlers[event].bind(this))\n    );\n  }\n\n  _reset(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.removeAll();\n    this._player.reset();\n  }\n\n  _destroy(): void {\n    this._shouldAutoPlay = true;\n    this._firstPlay = true;\n    this._eventManager.destroy();\n    this._player.destroy();\n  }\n\n  _onSourceSelected(event: FakeEvent, loadRequestData: Object, resolve: Function): void {\n    const source = event.payload.selectedSource[0];\n    this._handleAutoPlay(loadRequestData);\n    this._handleLiveDvr(loadRequestData);\n    this._setMediaInfo(loadRequestData, source);\n    this._maybeSetDrmLicenseUrl(source);\n    const sources = this._player.config.sources;\n    if (sources.options && sources.options.forceRedirectExternalStreams) {\n      this._logger.debug('Redirect stream started');\n      Utils.Http.jsonp(loadRequestData.media.contentUrl, (data, url) => {\n        loadRequestData.media.contentUrl = sources.options.redirectExternalStreamsHandler(data, url);\n        this._logger.debug('Redirect stream ended', loadRequestData.media.contentUrl);\n        resolve(loadRequestData);\n      });\n    } else {\n      resolve(loadRequestData);\n    }\n  }\n\n  _setMediaInfo(loadRequestData: Object, source: Object): void {\n    loadRequestData.media.contentId = loadRequestData.media.contentId || source.id;\n    loadRequestData.media.contentUrl = loadRequestData.media.contentUrl || source.url;\n    loadRequestData.media.contentType = loadRequestData.media.contentType || source.mimetype;\n    loadRequestData.media.streamType = this._player.isLive() ? cast.framework.messages.StreamType.LIVE : cast.framework.messages.StreamType.BUFFERED;\n    loadRequestData.media.metadata = loadRequestData.media.metadata || new cast.framework.messages.GenericMediaMetadata();\n    loadRequestData.media.metadata.title = loadRequestData.media.metadata.title || this._player.config.sources.metadata.name;\n    loadRequestData.media.metadata.subtitle = loadRequestData.media.metadata.subtitle || this._player.config.sources.metadata.description;\n    loadRequestData.media.metadata.images = loadRequestData.media.metadata.images || [{url: this._player.config.sources.poster}];\n    loadRequestData.media.hlsSegmentFormat = loadRequestData.media.hlsSegmentFormat || cast.framework.messages.HlsSegmentFormat.TS;\n    this._logger.debug('Media info has been set', loadRequestData);\n  }\n\n  _handleAutoPlay(loadRequestData: Object): void {\n    if (!loadRequestData.autoplay) {\n      this._shouldAutoPlay = false;\n      loadRequestData.autoplay = true;\n    }\n  }\n\n  _handleLiveDvr(loadRequestData: Object): void {\n    if (this._player.isDvr()) {\n      if (loadRequestData.currentTime === LIVE_EDGE) {\n        delete loadRequestData.currentTime;\n        this._logger.debug(`Live DVR will seek to live edge`);\n      }\n      // Workaround to avoid Live & Dvr seek issue\n      this._playerManager.removeSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    } else if (!this._player.isLive()) {\n      this._playerManager.addSupportedMediaCommands(cast.framework.messages.Command.SEEK);\n    }\n  }\n\n  _maybeSetDrmLicenseUrl(source: Object): void {\n    if (source.drmData) {\n      const data = source.drmData.find(data => data.scheme === DrmScheme.WIDEVINE);\n      if (data) {\n        this._playerManager.setMediaPlaybackInfoHandler((loadRequest, playbackConfig) => {\n          playbackConfig.protectionSystem = cast.framework.ContentProtection.WIDEVINE;\n          playbackConfig.licenseUrl = data.licenseUrl;\n          this._logger.debug(`Set drm license url`, playbackConfig);\n          return playbackConfig;\n        });\n      }\n    }\n  }\n\n  _onPlayEvent(): void {\n    this._logger.debug('Play event', {firstPlay: this._firstPlay});\n    if (this._firstPlay) {\n      if (this._shouldAutoPlay) {\n        this._player.play();\n      } else {\n        this._playerManager.pause();\n      }\n      this._firstPlay = false;\n    }\n  }\n\n  _onRequestPlayEvent(): void {\n    this._logger.debug('Request play event');\n    this._player.play();\n  }\n\n  _onRequestPauseEvent(): void {\n    this._logger.debug('Request pause event');\n    this._player.pause();\n  }\n\n  _onPlayerLoadCompleteEvent(): void {\n    const loadPlayerAndSetInitialTracks = () => {\n      this._player.load();\n      this._player.ready().then(() => this._tracksManager.setInitialTracks());\n    };\n    this._logger.debug('Player load complete');\n    if (this._adsManager.adBreak()) {\n      this._eventManager.listenOnce(this._player, this._player.Event.AD_BREAK_END, () => {\n        this._eventManager.listenOnce(this._player, this._player.Event.PLAYING, loadPlayerAndSetInitialTracks);\n      });\n    } else {\n      loadPlayerAndSetInitialTracks();\n    }\n  }\n\n  _onSystemVolumeChangedEvent(systemVolumeChangedEvent: Object): void {\n    const data = systemVolumeChangedEvent.data;\n    if (this._player.volume !== data.level) {\n      this._player.volume = data.level;\n    }\n    if (this._player.muted !== data.muted) {\n      this._player.muted = data.muted;\n    }\n  }\n\n  _onCustomMessage(customMessageEvent: Object): void {\n    const customMessage = customMessageEvent.data;\n    this._logger.debug('Custom message received', customMessage);\n    switch (customMessage.type) {\n      case CustomMessageType.ACTION:\n        this._handleCustomAction(customMessage);\n        break;\n      default:\n        break;\n    }\n  }\n\n  _handleCustomAction(customAction: CustomActionMessage): void {\n    switch (customAction.action) {\n      case CustomActionType.SKIP_AD:\n        this._adsManager.skipAd();\n        break;\n      default:\n        break;\n    }\n  }\n\n  _maybeCreateVmapAdsRequest(media: Object): Object {\n    if (media.customData && media.customData.vmapAdsRequest) {\n      media.vmapAdsRequest = media.customData.vmapAdsRequest;\n    }\n  }\n\n  _maybeReplaceAdTagTimestamp(media: Object): void {\n    const replaceTimestamp = adtag => {\n      if (adtag && regex.test(adtag)) {\n        const match = adtag.match(regex);\n        return adtag.replace(match[1], Date.now());\n      }\n      return adtag;\n    };\n    const regex = /correlator=(\\[timestamp\\])/;\n    if (media.breakClips) {\n      const breakClips = media.breakClips;\n      breakClips.forEach(breakClip => {\n        if (breakClip.vastAdsRequest && breakClip.vastAdsRequest.adTagUrl) {\n          breakClip.vastAdsRequest.adTagUrl = replaceTimestamp(breakClip.vastAdsRequest.adTagUrl);\n        }\n      });\n    }\n    if (media.vmapAdsRequest) {\n      media.vmapAdsRequest.adTagUrl = replaceTimestamp(media.vmapAdsRequest.adTagUrl);\n    }\n  }\n}\n\nexport {ReceiverManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-manager.js","// @flow\nimport {core, setup} from 'kaltura-player-js';\nimport {CastEngine} from './cast-engine';\nimport {DefaultPlayerConfig} from './default-player-config';\nimport {ReceiverError} from './error/error';\nimport {ErrorType} from './error/error-type';\n\nconst {Utils, unRegisterEngine, registerEngine, EngineType} = core;\n\nexport const CAST_MEDIA_PLAYER_TAG: string = 'cast-media-player';\nconst PLAYER_CONTAINER: string = 'kaltura-receiver-player-container';\n\nclass PlayerLoader {\n  static loadPlayer(config: Object): Object {\n    const castMediaPlayerEl = Utils.Dom.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      const castMediaElement = castMediaPlayerEl.getMediaElement();\n      castMediaElement.style.position = 'absolute';\n      const playerContainerEl = Utils.Dom.createElement('div');\n      playerContainerEl.id = PLAYER_CONTAINER;\n      Utils.Dom.appendChild(document.body, playerContainerEl);\n      unRegisterEngine(EngineType.HTML5);\n      registerEngine(EngineType.CAST, CastEngine);\n      const playerConfig = Utils.Object.mergeDeep({targetId: PLAYER_CONTAINER}, DefaultPlayerConfig, config);\n      const player = setup(playerConfig);\n      Utils.Dom.prependTo(playerContainerEl, castMediaElement.parentNode);\n      return player;\n    } else {\n      throw new ReceiverError(ErrorType.CAST_ELEMENT_NOT_FOUND);\n    }\n  }\n}\n\nexport {PlayerLoader};\n\n\n\n// WEBPACK FOOTER //\n// ./player-loader.js","// @flow\nimport {ReceiverManagerAPI} from './receiver-manager-api';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nexport {ReceiverManagerAPI as Receiver};\nexport {__VERSION__ as VERSION, __NAME__ as NAME};\n\n\n\n// WEBPACK FOOTER //\n// ./index.js","// @flow\nimport {ReceiverManager} from './receiver-manager';\n\nlet receiverManager;\n\n/**\n * Kaltura Receiver Player SDK.\n * @class Receiver\n * @param {KPReceiverOptionsObject} config - The receiver SDK configuration.\n */\nclass ReceiverManagerAPI {\n  constructor(config: KPReceiverOptionsObject) {\n    receiverManager = new ReceiverManager(config);\n  }\n\n  /**\n   * Initializes the receiver SDK, so that receiver app can receive requests from senders.\n   * Internally calls to cast.framework.CastReceiverContext.start() to initializes system manager and media manager.\n   * @public\n   * @instance\n   * @param {Object=} options - Cast receiver context options. All options are optional. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.CastReceiverOptions|cast.framework.CastReceiverOptions}\n   * @returns {void}\n   * @memberof Receiver\n   */\n  start(options?: Object = {}): void {\n    receiverManager.start(options);\n  }\n\n  /**\n   * The LOAD default handler of the receiver SDK. This handler should be called just in case LOAD interceptor is override by the app, otherwise it will be called internally.\n   * @public\n   * @instance\n   * @param {Object} loadRequestData - Media event LOAD request data. See {@link https://developers.google.com/cast/docs/reference/caf_receiver/cast.framework.messages.LoadRequestData|cast.framework.messages.LoadRequestData}\n   * @returns {Promise<Object>} - The load promise.\n   * @memberof Receiver\n   */\n  onLoad(loadRequestData: Object): Promise<Object> {\n    return receiverManager.onLoad(loadRequestData);\n  }\n\n  /**\n   * Adding an event listener to a receiver player event.\n   * @public\n   * @instance\n   * @param {string} type - The event type.\n   * @param {Function} listener - The event handler.\n   * @returns {void}\n   * @memberof Receiver\n   */\n  addEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().addEventListener(type, listener);\n  }\n\n  /**\n   * Removing an event listener from a receiver player event.\n   * @public\n   * @instance\n   * @param {string} type - The event type.\n   * @param {Function} listener - The event handler.\n   * @returns {void}\n   * @memberof Receiver\n   */\n  removeEventListener(type: string, listener: Function): void {\n    receiverManager.getPlayer().removeEventListener(type, listener);\n  }\n}\n\nexport {ReceiverManagerAPI};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-manager-api.js","// @flow\nimport {core} from 'kaltura-player-js';\nimport {CAST_MEDIA_PLAYER_TAG} from './player-loader';\n\nconst {Track, Utils, FakeEvent, MediaType, getLogger, FakeEventTarget, EventManager, EventType, AudioTrack, TextTrack, AbrMode, MimeType} = core;\n\nclass CastEngine extends FakeEventTarget {\n  static get id(): string {\n    return 'cast';\n  }\n\n  static canPlaySource(source: Object): boolean {\n    const mimeType = source.mimetype.toLowerCase();\n    const supported = CastEngine._supportedMimeTypes.includes(mimeType);\n    if (supported) {\n      if (source.drmData) {\n        return MimeType.DASH.includes(mimeType);\n      }\n      return true;\n    }\n    return false;\n  }\n\n  static createEngine(source: Object, config: Object): Object {\n    return new this(source, config);\n  }\n\n  static _logger: any = getLogger('CastEngine');\n\n  static _supportedMimeTypes: Array<string> = [...MimeType.HLS, ...MimeType.DASH, ...MimeType.PROGRESSIVE, ...MimeType.SMOOTH_STREAMING];\n\n  _el: HTMLVideoElement;\n  _source: Object;\n  _config: Object;\n  _eventManager: EventManager;\n  _isLoaded: boolean = false;\n  _tracks: Array<Track> = [];\n  _volume: number = 1;\n  _muted: boolean = false;\n  _paused: boolean = false;\n  _seeking: boolean = false;\n  _ended: boolean = false;\n  _mediaElementEvents: Array<string> = [\n    EventType.ABORT,\n    EventType.CAN_PLAY,\n    EventType.CAN_PLAY_THROUGH,\n    EventType.DURATION_CHANGE,\n    EventType.EMPTIED,\n    EventType.ENDED,\n    EventType.LOADED_DATA,\n    EventType.LOADED_METADATA,\n    EventType.LOAD_START,\n    EventType.PAUSE,\n    EventType.PLAY,\n    EventType.PLAYING,\n    EventType.PROGRESS,\n    EventType.RATE_CHANGE,\n    EventType.SEEKED,\n    EventType.SEEKING,\n    EventType.STALLED,\n    EventType.TIME_UPDATE,\n    EventType.SUSPEND,\n    EventType.WAITING\n  ];\n\n  constructor(source: Object, config: Object) {\n    super();\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._eventManager = new EventManager();\n    this._createVideoElement();\n    this._init(source, config);\n  }\n\n  restore(source: Object, config: Object): void {\n    this.reset();\n    this._init(source, config);\n  }\n\n  attach(): void {\n    const videoElement = this.getVideoElement();\n    this._eventManager.listen(videoElement, EventType.SEEKED, () => (this._seeking = false));\n    this._eventManager.listen(videoElement, EventType.SEEKING, () => (this._seeking = true));\n    this._eventManager.listen(videoElement, EventType.ENDED, () => {\n      this._ended = true;\n      // Receiver has a problem where the current time isn't equals to the duration when\n      // playback is ended. This prevent from analytics plugins to report 100% reached.\n      // So we're trigger time update event again on ended and take care to handle this state also in the\n      // current time setter.\n      if (!this.isLive()) {\n        this.dispatchEvent(new FakeEvent(EventType.TIME_UPDATE));\n      }\n    });\n    if (this.isLive()) {\n      this._eventManager.listen(videoElement, EventType.TIME_UPDATE, () => this._playerManager.broadcastStatus(true));\n    }\n    this._mediaElementEvents.forEach(mediaElementEvent =>\n      this._eventManager.listen(videoElement, mediaElementEvent, () => this.dispatchEvent(new FakeEvent(mediaElementEvent)))\n    );\n  }\n\n  detach(): void {\n    // Empty implementation\n  }\n\n  static runCapabilities(): void {\n    // Empty implementation\n  }\n\n  static prepareVideoElement(): void {\n    // Empty implementation\n  }\n\n  static getCapabilities(): Promise<Object> {\n    return Promise.resolve({\n      [CastEngine.id]: {\n        autoplay: true,\n        mutedAutoPlay: true\n      }\n    });\n  }\n\n  get id(): string {\n    return CastEngine.id;\n  }\n\n  getVideoElement(): HTMLVideoElement {\n    return this._el;\n  }\n\n  load(startTime: ?number): Promise<Object> {\n    CastEngine._logger.debug('Load start', startTime);\n    this._isLoaded = true;\n    this._parseTracks();\n    this.dispatchEvent(new FakeEvent(EventType.ABR_MODE_CHANGED, {mode: AbrMode.AUTO}));\n    CastEngine._logger.debug('Load end', this._tracks);\n    return Promise.resolve({tracks: this._tracks});\n  }\n\n  play(): void {\n    this._paused = false;\n  }\n\n  pause(): void {\n    this._paused = true;\n  }\n\n  hideTextTrack(): void {\n    // Empty implementation\n  }\n\n  selectTextTrack(textTrack: TextTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.TEXT_TRACK_CHANGED, {selectedTextTrack: textTrack}));\n  }\n\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.AUDIO_TRACK_CHANGED, {selectedAudioTrack: audioTrack}));\n  }\n\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    this.dispatchEvent(new FakeEvent(EventType.VIDEO_TRACK_CHANGED, {selectedVideoTrack: videoTrack}));\n  }\n\n  enableAdaptiveBitrate(): void {\n    // Empty implementation\n  }\n\n  isAdaptiveBitrateEnabled(): boolean {\n    return true;\n  }\n\n  getSelectedSource(): Object {\n    return Utils.Object.copyDeep(this._source);\n  }\n\n  isLive() {\n    return this._config.sources.type === MediaType.LIVE;\n  }\n\n  seekToLiveEdge(): void {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      this._playerManager.seek(range.end);\n    }\n  }\n\n  getStartTimeOfDvrWindow(): number {\n    const range = this._playerManager.getLiveSeekableRange();\n    if (range) {\n      return range.start;\n    }\n    return 0;\n  }\n\n  reset(): void {\n    this._eventManager.removeAll();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n  }\n\n  destroy(): void {\n    this._eventManager.destroy();\n    this._tracks = [];\n    this._isLoaded = false;\n    this._mediaElementEvents = [];\n    this._volume = 1;\n    this._muted = false;\n    this._paused = false;\n    this._seeking = false;\n    this._ended = false;\n    if (this._el) {\n      Utils.Dom.removeAttribute(this._el, 'src');\n      Utils.Dom.removeChild(this._el.parentNode, this._el);\n    }\n  }\n\n  set currentTime(value: number): void {\n    // Empty implementation\n  }\n\n  get currentTime(): number {\n    if (this.isLive()) {\n      return this._playerManager.getCurrentTimeSec() - this.getStartTimeOfDvrWindow();\n    }\n    if (this._ended) {\n      return this._playerManager.getDurationSec();\n    }\n    return this._playerManager.getCurrentTimeSec();\n  }\n\n  set muted(value: boolean): void {\n    this._muted = value;\n  }\n\n  get muted(): boolean {\n    return this._muted;\n  }\n\n  set volume(value: number): void {\n    this._volume = value;\n    this.dispatchEvent(EventType.VOLUME_CHANGE);\n  }\n\n  get volume(): number {\n    return this._volume;\n  }\n\n  get paused(): boolean {\n    return this._paused;\n  }\n\n  get seeking(): boolean {\n    return this._seeking;\n  }\n\n  get buffered(): Array<any> {\n    return [];\n  }\n\n  get duration(): number {\n    if (this.isLive()) {\n      const range = this._playerManager.getLiveSeekableRange();\n      if (range) {\n        return range.end - this.getStartTimeOfDvrWindow();\n      }\n    }\n    return this._playerManager.getDurationSec();\n  }\n\n  get src(): string {\n    return this._isLoaded ? this._source.url : '';\n  }\n\n  set playsinline(playsinline: boolean): void {\n    // Empty implementation\n  }\n\n  get playsinline(): boolean {\n    return true;\n  }\n\n  set playbackRate(playbackRate: number): void {\n    // Empty implementation\n  }\n\n  get playbackRate(): number {\n    return this._playerManager.getPlaybackRate();\n  }\n\n  get playbackRates(): Array<number> {\n    return [1];\n  }\n\n  get defaultPlaybackRate(): number {\n    return 1;\n  }\n\n  set crossOrigin(crossOrigin: ?string): void {\n    // Empty implementation\n  }\n\n  get crossOrigin(): ?string {\n    // Empty implementation\n  }\n\n  get ended(): boolean {\n    return this._ended;\n  }\n\n  _createVideoElement(): void {\n    const castMediaPlayerEl: Object = document.getElementsByTagName(CAST_MEDIA_PLAYER_TAG)[0];\n    if (castMediaPlayerEl) {\n      this._el = castMediaPlayerEl.getMediaElement();\n    }\n  }\n\n  _init(source: Object, config: Object): void {\n    this._source = source;\n    this._config = config;\n    this.attach();\n  }\n\n  _parseTracks(): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const castAudioTracks = audioTracksManager.getTracks();\n    const audioTracks = this._parseAudioTracks(castAudioTracks);\n\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    const castTextTracks = textTracksManager.getTracks();\n    const textTracks = this._parseTextTracks(castTextTracks);\n\n    this._tracks = audioTracks.concat(textTracks);\n  }\n\n  _parseTextTracks(castTextTracks: Array<Object>): Array<TextTrack> {\n    const textTracks = [];\n    castTextTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        kind: track.subType || 'subtitles',\n        active: false\n      };\n      textTracks.push(new TextTrack(settings));\n    });\n    return textTracks;\n  }\n\n  _parseAudioTracks(castAudioTracks: Array<Object>): Array<AudioTrack> {\n    const audioTracks = [];\n    castAudioTracks.forEach(track => {\n      const settings: Object = {\n        id: track.trackId,\n        index: track.trackId - 1,\n        label: track.name,\n        language: track.language,\n        active: false\n      };\n      audioTracks.push(new AudioTrack(settings));\n    });\n    return audioTracks;\n  }\n}\n\nexport {CastEngine};\n\n\n\n// WEBPACK FOOTER //\n// ./cast-engine.js","// @flow\nimport {core} from 'kaltura-player-js';\n\nconst {StreamType, EngineType} = core;\n\nconst DefaultPlayerConfig: Object = {\n  playback: {\n    autoplay: false,\n    preload: 'none',\n    disableUserCache: true,\n    streamPriority: [\n      {\n        engine: EngineType.CAST,\n        format: StreamType.HLS\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.DASH\n      },\n      {\n        engine: EngineType.CAST,\n        format: StreamType.PROGRESSIVE\n      }\n    ]\n  },\n  ui: {\n    disable: true\n  }\n};\n\nexport {DefaultPlayerConfig};\n\n\n\n// WEBPACK FOOTER //\n// ./default-player-config.js","// @flow\nclass ReceiverError {\n  code: number;\n  description: string;\n\n  constructor(type: Object) {\n    this.code = type.code;\n    this.description = type.description;\n  }\n}\n\nexport {ReceiverError};\n\n\n\n// WEBPACK FOOTER //\n// ./error/error.js","// @flow\nconst ErrorType: {[type: string]: Object} = {\n  CAST_ELEMENT_NOT_FOUND: {\n    code: 100020,\n    description: \"<cast-media-element> tag isn't found in the DOM\"\n  }\n};\n\nexport {ErrorType};\n\n\n\n// WEBPACK FOOTER //\n// ./error/error-type.js","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\n\nconst {TextStyleConverter} = remote;\nconst {TrackType, getLogger} = core;\n\nclass ReceiverTracksManager {\n  _logger: any = getLogger('ReceiverTracksManager');\n  _playerManager: Object;\n  _player: Object;\n\n  constructor(player: Object) {\n    this._playerManager = cast.framework.CastReceiverContext.getInstance().getPlayerManager();\n    this._player = player;\n    this._attachListeners();\n  }\n\n  setInitialTracks(): void {\n    const mediaInfo = this._playerManager.getMediaInformation();\n    this._logger.debug('Set initial tracks', mediaInfo.customData);\n    if (mediaInfo.customData) {\n      this._setInitialAudioTrack(mediaInfo.customData.audioLanguage);\n      this._setInitialTextTrack(mediaInfo.customData.textLanguage);\n    }\n  }\n\n  _attachListeners(): void {\n    this._playerManager.addEventListener(cast.framework.events.EventType.REQUEST_EDIT_TRACKS_INFO, requestEvent => {\n      const activeTrackIds = requestEvent.requestData.activeTrackIds;\n      if (activeTrackIds) {\n        this._handleAudioTrackSelection(activeTrackIds);\n        this._handleTextTrackSelection(activeTrackIds);\n      } else {\n        const textTrackStyle = requestEvent.requestData.textTrackStyle;\n        this._handleTextStyleSelection(textTrackStyle);\n      }\n    });\n  }\n\n  _handleTextTrackSelection(activeTrackIds: Array<number>): void {\n    const textTracks = this._player.getTracks(TrackType.TEXT);\n    const activeTextTrack = textTracks.find(t => t.active);\n    const nextActiveTextTrack = textTracks.find(t => activeTrackIds.includes(t.id));\n    if (nextActiveTextTrack) {\n      this._player.selectTrack(nextActiveTextTrack);\n    } else if (activeTextTrack && activeTextTrack.language !== 'off') {\n      const offTrack = textTracks.find(t => t.language === 'off');\n      this._player.selectTrack(offTrack);\n    }\n  }\n\n  _handleAudioTrackSelection(activeTrackIds: Array<number>): void {\n    const audioTracks = this._player.getTracks(TrackType.AUDIO);\n    const activeAudioTrack = audioTracks.find(t => t.active);\n    const nextActiveAudioTrack = audioTracks.find(t => activeTrackIds.includes(t.id));\n    if (activeAudioTrack && nextActiveAudioTrack && activeAudioTrack.id !== nextActiveAudioTrack.id) {\n      this._player.selectTrack(nextActiveAudioTrack);\n    }\n  }\n\n  _handleTextStyleSelection(textStyle: Object): void {\n    this._player.textStyle = TextStyleConverter.toPlayerTextStyle(textStyle);\n  }\n\n  _setInitialTextTrack(textLanguage: ?string): void {\n    const textTracksManager = this._playerManager.getTextTracksManager();\n    if (textLanguage) {\n      this._logger.debug('Set initial text track - setActiveByLanguage', textLanguage);\n      textTracksManager.setActiveByLanguage(textLanguage);\n    }\n  }\n\n  _setInitialAudioTrack(audioLanguage: ?string): void {\n    const audioTracksManager = this._playerManager.getAudioTracksManager();\n    const audioTracks = audioTracksManager.getTracks();\n    this._logger.debug('Set initial audio track', audioLanguage, audioTracks);\n    if (audioTracks.length > 0) {\n      if (audioLanguage) {\n        this._logger.debug('Set initial audio track - setActiveByLanguage', audioLanguage);\n        audioTracksManager.setActiveByLanguage(audioLanguage);\n      } else {\n        const audioTrackId = audioTracks[0].trackId;\n        const audioTrack = this._player.getTracks(TrackType.AUDIO).find(t => t.id === audioTrackId);\n        if (audioTrack) {\n          this._logger.debug('Set initial audio track - setActiveById', audioTrackId);\n          audioTracksManager.setActiveById(audioTrackId);\n          this._player.selectTrack(audioTrack);\n        }\n      }\n    }\n  }\n}\n\nexport {ReceiverTracksManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-tracks-manager.js","// @flow\nimport {cast as remote, core} from 'kaltura-player-js';\nimport {CUSTOM_CHANNEL} from './receiver-manager';\n\nconst {EventType, Ad, AdBreak, AdBreakType, getLogger, FakeEvent} = core;\nconst {CustomEventMessage} = remote;\n\nclass ReceiverAdsManager {\n  _logger: any = getLogger('ReceiverAdsManager');\n  _context: Object;\n  _playerManager: Object;\n  _player: Object;\n  _adProgressIntervalId: ?number;\n  _ad: ?Ad;\n  _adBreak: ?AdBreak;\n  _adIsPlaying: boolean;\n  _adCanSkipTriggered: false;\n  _adLifecycleEventHandlers: {[event: string]: Function};\n  _adTrackingEventHandlers: {[event: string]: Function};\n  _playerEventHandlers: {[event: string]: Function};\n  _timePercentEvent: {[time: string]: boolean} = {\n    AD_REACHED_25_PERCENT: false,\n    AD_REACHED_50_PERCENT: false,\n    AD_REACHED_75_PERCENT: false\n  };\n\n  constructor(player: Object) {\n    this._context = cast.framework.CastReceiverContext.getInstance();\n    this._playerManager = this._context.getPlayerManager();\n    this._player = player;\n    this._bindMethods();\n    this._attachListeners();\n  }\n\n  skipAd(): void {\n    this._logger.debug('Skip ad');\n    const requestData = new cast.framework.messages.RequestData(cast.framework.messages.MessageType.SKIP_AD);\n    this._playerManager.sendLocalMediaRequest(requestData);\n  }\n\n  adBreak(): boolean {\n    return !!this._adBreak;\n  }\n\n  _bindMethods(): void {\n    this._onPlayerLoadComplete = this._onPlayerLoadComplete.bind(this);\n    this._onBreakStarted = this._onBreakStarted.bind(this);\n    this._onBreakEnded = this._onBreakEnded.bind(this);\n    this._onBreakClipLoading = this._onBreakClipLoading.bind(this);\n    this._onBreakClipStarted = this._onBreakClipStarted.bind(this);\n    this._onBreakClipEnded = this._onBreakClipEnded.bind(this);\n    this._onAdPaused = this._onAdPaused.bind(this);\n    this._onAdResumed = this._onAdResumed.bind(this);\n    this._onAdProgress = this._onAdProgress.bind(this);\n    this._onMuteChange = this._onMuteChange.bind(this);\n    this._onVolumeChange = this._onVolumeChange.bind(this);\n  }\n\n  _attachListeners(): void {\n    this._adLifecycleEventHandlers = {\n      [cast.framework.events.EventType.PLAYER_LOAD_COMPLETE]: this._onPlayerLoadComplete,\n      [cast.framework.events.EventType.BREAK_STARTED]: this._onBreakStarted,\n      [cast.framework.events.EventType.BREAK_ENDED]: this._onBreakEnded,\n      [cast.framework.events.EventType.BREAK_CLIP_LOADING]: this._onBreakClipLoading,\n      [cast.framework.events.EventType.BREAK_CLIP_STARTED]: this._onBreakClipStarted,\n      [cast.framework.events.EventType.BREAK_CLIP_ENDED]: this._onBreakClipEnded\n    };\n    this._adTrackingEventHandlers = {\n      [cast.framework.events.EventType.PAUSE]: this._onAdPaused,\n      [cast.framework.events.EventType.PLAY]: this._onAdResumed\n    };\n    this._playerEventHandlers = {\n      [EventType.MUTE_CHANGE]: this._onMuteChange,\n      [EventType.VOLUME_CHANGE]: this._onVolumeChange\n    };\n    Object.keys(this._adLifecycleEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adLifecycleEventHandlers[event]));\n  }\n\n  _onPlayerLoadComplete(): void {\n    const positions = [];\n    const breakManager = this._playerManager.getBreakManager();\n    if (breakManager) {\n      const breaks = breakManager.getBreaks();\n      if (breaks && breaks.length > 0) {\n        breaks.forEach(b => positions.push(b.position));\n        this._sendEventAndCustomMessage(this._player.Event.AD_MANIFEST_LOADED, {adBreaksPosition: positions});\n      }\n    }\n  }\n\n  _onBreakStarted(breaksEvent: Object): void {\n    this._toggleAdBreakListeners(true);\n    const adBreakOptions = this._getAdBreakOptions(breaksEvent);\n    const adBreak = new AdBreak(adBreakOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_START, {adBreak: adBreak});\n    this._adBreak = adBreak;\n  }\n\n  _onBreakEnded(breaksEvent: Object): void {\n    this._toggleAdBreakListeners(false);\n    this._sendEventAndCustomMessage(this._player.Event.AD_BREAK_END);\n    this._adBreak = null;\n    const breaks = this._playerManager.getBreakManager().getBreaks();\n    const index = breaks.findIndex(b => b.id === breaksEvent.breakId);\n    if (index + 1 === breaks.length) {\n      this._sendEventAndCustomMessage(this._player.Event.ALL_ADS_COMPLETED);\n    }\n  }\n\n  _onBreakClipLoading(breaksEvent: Object): void {\n    const adOptions = this._getAdOptions(breaksEvent);\n    const ad = new Ad(breaksEvent.breakClipId, adOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_LOADED, {ad: ad});\n    this._ad = ad;\n  }\n\n  _onBreakClipStarted(breaksEvent: Object): void {\n    const adOptions = this._getAdOptions(breaksEvent);\n    const ad = new Ad(breaksEvent.breakClipId, adOptions);\n    this._sendEventAndCustomMessage(this._player.Event.AD_STARTED, {ad});\n    this._adIsPlaying = true;\n  }\n\n  _onBreakClipEnded(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_COMPLETED);\n    this._adIsPlaying = false;\n    this._adCanSkipTriggered = false;\n    this._ad = null;\n  }\n\n  _onAdPaused(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_PAUSED);\n    this._adIsPlaying = false;\n  }\n\n  _onAdResumed(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_RESUMED);\n    this._adIsPlaying = true;\n  }\n\n  _onAdProgress(): void {\n    if (!this._ad) return;\n    const adDuration = this._playerManager.getBreakClipDurationSec();\n    const adCurrentTime = this._playerManager.getBreakClipCurrentTimeSec();\n    const percent = adCurrentTime / adDuration;\n    if (!this._timePercentEvent.AD_REACHED_25_PERCENT && percent >= 0.25) {\n      this._timePercentEvent.AD_REACHED_25_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_FIRST_QUARTILE);\n    }\n    if (!this._timePercentEvent.AD_REACHED_50_PERCENT && percent >= 0.5) {\n      this._timePercentEvent.AD_REACHED_50_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_MIDPOINT);\n    }\n    if (!this._timePercentEvent.AD_REACHED_75_PERCENT && percent >= 0.75) {\n      this._timePercentEvent.AD_REACHED_75_PERCENT = true;\n      this._sendEventAndCustomMessage(this._player.Event.AD_THIRD_QUARTILE);\n    }\n    if (!this._adCanSkipTriggered && this._ad.skippable) {\n      if (adCurrentTime >= this._ad.skipOffset) {\n        this._sendEventAndCustomMessage(this._player.Event.AD_CAN_SKIP);\n        this._adCanSkipTriggered = true;\n      }\n    }\n    this._sendEventAndCustomMessage(this._player.Event.AD_PROGRESS, {\n      adProgress: {\n        currentTime: adCurrentTime,\n        duration: adDuration\n      }\n    });\n  }\n\n  _onMuteChange(): void {\n    if (this._player.muted) {\n      this._sendEventAndCustomMessage(this._player.Event.AD_MUTED);\n    }\n  }\n\n  _onVolumeChange(): void {\n    this._sendEventAndCustomMessage(this._player.Event.AD_VOLUME_CHANGED);\n  }\n\n  _toggleAdBreakListeners(toggle: boolean): void {\n    if (toggle) {\n      Object.keys(this._adTrackingEventHandlers).forEach(event => this._playerManager.addEventListener(event, this._adTrackingEventHandlers[event]));\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.addEventListener(event, this._playerEventHandlers[event]));\n      this._adProgressIntervalId = setInterval(this._onAdProgress, 300);\n    } else {\n      Object.keys(this._adTrackingEventHandlers).forEach(event =>\n        this._playerManager.removeEventListener(event, this._adTrackingEventHandlers[event])\n      );\n      Object.keys(this._playerEventHandlers).forEach(event => this._player.removeEventListener(event, this._playerEventHandlers[event]));\n      clearInterval(this._adProgressIntervalId);\n      this._adProgressIntervalId = null;\n    }\n  }\n\n  _getAdBreakOptions(breaksEvent: Object): Object {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    if (currentBreak) {\n      options.position = currentBreak.position;\n      options.type = this._getAdBreakTypeByPosition(currentBreak.position);\n      options.numAds = currentBreak.breakClipIds.length;\n    }\n    return options;\n  }\n\n  _getAdBreakTypeByPosition(position: number): void {\n    switch (position) {\n      case 0:\n        return AdBreakType.PRE;\n      case -1:\n        return AdBreakType.POST;\n      default:\n        return AdBreakType.MID;\n    }\n  }\n\n  _getAdOptions(breaksEvent: Object): Object {\n    const options = {};\n    const currentBreak = this._playerManager.getBreakManager().getBreakById(breaksEvent.breakId);\n    if (currentBreak) {\n      const currentBreakClip = this._playerManager.getBreakManager().getBreakClipById(breaksEvent.breakClipId);\n      options.url = currentBreakClip.contentId;\n      options.contentType = currentBreakClip.contentType;\n      options.title = currentBreakClip.title;\n      options.position = currentBreak.breakClipIds.indexOf(currentBreakClip.id) + 1;\n      options.duration = currentBreakClip.duration;\n      options.clickThroughUrl = currentBreakClip.clickThroughUrl;\n      options.posterUrl = currentBreakClip.posterUrl;\n      options.skipOffset = currentBreakClip.whenSkippable;\n      options.linear = true;\n    }\n    return options;\n  }\n\n  _sendEventAndCustomMessage(event: string, payload: any): void {\n    this._logger.debug(event.toUpperCase(), payload);\n    this._player.dispatchEvent(new FakeEvent(event, payload));\n    this._context.sendCustomMessage(CUSTOM_CHANNEL, undefined, new CustomEventMessage(event, payload));\n  }\n}\n\nexport {ReceiverAdsManager};\n\n\n\n// WEBPACK FOOTER //\n// ./receiver-ads-manager.js"],"sourceRoot":""}